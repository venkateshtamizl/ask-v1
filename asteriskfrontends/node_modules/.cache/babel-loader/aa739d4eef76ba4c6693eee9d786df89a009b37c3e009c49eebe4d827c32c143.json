{"ast":null,"code":"\"use strict\";\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\nvar Logger = require('./Logger');\nvar Utils = require('./Utils');\nvar logger = new Logger('DigestAuthentication');\nmodule.exports = /*#__PURE__*/function () {\n  function DigestAuthentication(credentials) {\n    _classCallCheck(this, DigestAuthentication);\n    this._credentials = credentials;\n    this._cnonce = null;\n    this._nc = 0;\n    this._ncHex = '00000000';\n    this._algorithm = null;\n    this._realm = null;\n    this._nonce = null;\n    this._opaque = null;\n    this._stale = null;\n    this._qop = null;\n    this._method = null;\n    this._uri = null;\n    this._ha1 = null;\n    this._response = null;\n  }\n  _createClass(DigestAuthentication, [{\n    key: \"get\",\n    value: function get(parameter) {\n      switch (parameter) {\n        case 'realm':\n          return this._realm;\n        case 'ha1':\n          return this._ha1;\n        default:\n          logger.warn('get() | cannot get \"%s\" parameter', parameter);\n          return undefined;\n      }\n    }\n    /**\n    * Performs Digest authentication given a SIP request and the challenge\n    * received in a response to that request.\n    * Returns true if auth was successfully generated, false otherwise.\n    */\n  }, {\n    key: \"authenticate\",\n    value: function authenticate(_ref, challenge) /* test interface */\n    {\n      var method = _ref.method,\n        ruri = _ref.ruri,\n        body = _ref.body;\n      var cnonce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      this._algorithm = challenge.algorithm;\n      this._realm = challenge.realm;\n      this._nonce = challenge.nonce;\n      this._opaque = challenge.opaque;\n      this._stale = challenge.stale;\n      if (this._algorithm) {\n        if (this._algorithm !== 'MD5') {\n          logger.warn('authenticate() | challenge with Digest algorithm different than \"MD5\", authentication aborted');\n          return false;\n        }\n      } else {\n        this._algorithm = 'MD5';\n      }\n      if (!this._nonce) {\n        logger.warn('authenticate() | challenge without Digest nonce, authentication aborted');\n        return false;\n      }\n      if (!this._realm) {\n        logger.warn('authenticate() | challenge without Digest realm, authentication aborted');\n        return false;\n      } // If no plain SIP password is provided.\n\n      if (!this._credentials.password) {\n        // If ha1 is not provided we cannot authenticate.\n        if (!this._credentials.ha1) {\n          logger.warn('authenticate() | no plain SIP password nor ha1 provided, authentication aborted');\n          return false;\n        } // If the realm does not match the stored realm we cannot authenticate.\n\n        if (this._credentials.realm !== this._realm) {\n          logger.warn('authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:\"%s\", given:\"%s\"]', this._credentials.realm, this._realm);\n          return false;\n        }\n      } // 'qop' can contain a list of values (Array). Let's choose just one.\n\n      if (challenge.qop) {\n        if (challenge.qop.indexOf('auth-int') > -1) {\n          this._qop = 'auth-int';\n        } else if (challenge.qop.indexOf('auth') > -1) {\n          this._qop = 'auth';\n        } else {\n          // Otherwise 'qop' is present but does not contain 'auth' or 'auth-int', so abort here.\n          logger.warn('authenticate() | challenge without Digest qop different than \"auth\" or \"auth-int\", authentication aborted');\n          return false;\n        }\n      } else {\n        this._qop = null;\n      } // Fill other attributes.\n\n      this._method = method;\n      this._uri = ruri;\n      this._cnonce = cnonce || Utils.createRandomToken(12);\n      this._nc += 1;\n      var hex = Number(this._nc).toString(16);\n      this._ncHex = '00000000'.substr(0, 8 - hex.length) + hex; // Nc-value = 8LHEX. Max value = 'FFFFFFFF'.\n\n      if (this._nc === 4294967296) {\n        this._nc = 1;\n        this._ncHex = '00000001';\n      } // Calculate the Digest \"response\" value.\n      // If we have plain SIP password then regenerate ha1.\n\n      if (this._credentials.password) {\n        // HA1 = MD5(A1) = MD5(username:realm:password).\n        this._ha1 = Utils.calculateMD5(\"\".concat(this._credentials.username, \":\").concat(this._realm, \":\").concat(this._credentials.password));\n      } // Otherwise reuse the stored ha1.\n      else {\n        this._ha1 = this._credentials.ha1;\n      }\n      var a2;\n      var ha2;\n      if (this._qop === 'auth') {\n        // HA2 = MD5(A2) = MD5(method:digestURI).\n        a2 = \"\".concat(this._method, \":\").concat(this._uri);\n        ha2 = Utils.calculateMD5(a2);\n        logger.debug('authenticate() | using qop=auth [a2:\"%s\"]', a2); // Response = MD5(HA1:nonce:nonceCount:credentialsNonce:qop:HA2).\n\n        this._response = Utils.calculateMD5(\"\".concat(this._ha1, \":\").concat(this._nonce, \":\").concat(this._ncHex, \":\").concat(this._cnonce, \":auth:\").concat(ha2));\n      } else if (this._qop === 'auth-int') {\n        // HA2 = MD5(A2) = MD5(method:digestURI:MD5(entityBody)).\n        a2 = \"\".concat(this._method, \":\").concat(this._uri, \":\").concat(Utils.calculateMD5(body ? body : ''));\n        ha2 = Utils.calculateMD5(a2);\n        logger.debug('authenticate() | using qop=auth-int [a2:\"%s\"]', a2); // Response = MD5(HA1:nonce:nonceCount:credentialsNonce:qop:HA2).\n\n        this._response = Utils.calculateMD5(\"\".concat(this._ha1, \":\").concat(this._nonce, \":\").concat(this._ncHex, \":\").concat(this._cnonce, \":auth-int:\").concat(ha2));\n      } else if (this._qop === null) {\n        // HA2 = MD5(A2) = MD5(method:digestURI).\n        a2 = \"\".concat(this._method, \":\").concat(this._uri);\n        ha2 = Utils.calculateMD5(a2);\n        logger.debug('authenticate() | using qop=null [a2:\"%s\"]', a2); // Response = MD5(HA1:nonce:HA2).\n\n        this._response = Utils.calculateMD5(\"\".concat(this._ha1, \":\").concat(this._nonce, \":\").concat(ha2));\n      }\n      logger.debug('authenticate() | response generated');\n      return true;\n    }\n    /**\n    * Return the Proxy-Authorization or WWW-Authorization header value.\n    */\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      var auth_params = [];\n      if (!this._response) {\n        throw new Error('response field does not exist, cannot generate Authorization header');\n      }\n      auth_params.push(\"algorithm=\".concat(this._algorithm));\n      auth_params.push(\"username=\\\"\".concat(this._credentials.username, \"\\\"\"));\n      auth_params.push(\"realm=\\\"\".concat(this._realm, \"\\\"\"));\n      auth_params.push(\"nonce=\\\"\".concat(this._nonce, \"\\\"\"));\n      auth_params.push(\"uri=\\\"\".concat(this._uri, \"\\\"\"));\n      auth_params.push(\"response=\\\"\".concat(this._response, \"\\\"\"));\n      if (this._opaque) {\n        auth_params.push(\"opaque=\\\"\".concat(this._opaque, \"\\\"\"));\n      }\n      if (this._qop) {\n        auth_params.push(\"qop=\".concat(this._qop));\n        auth_params.push(\"cnonce=\\\"\".concat(this._cnonce, \"\\\"\"));\n        auth_params.push(\"nc=\".concat(this._ncHex));\n      }\n      return \"Digest \".concat(auth_params.join(', '));\n    }\n  }]);\n  return DigestAuthentication;\n}();","map":{"version":3,"names":["_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","Logger","require","Utils","logger","module","exports","DigestAuthentication","credentials","_credentials","_cnonce","_nc","_ncHex","_algorithm","_realm","_nonce","_opaque","_stale","_qop","_method","_uri","_ha1","_response","value","get","parameter","warn","undefined","authenticate","_ref","challenge","method","ruri","body","cnonce","arguments","algorithm","realm","nonce","opaque","stale","password","ha1","qop","indexOf","createRandomToken","hex","Number","toString","substr","calculateMD5","concat","username","a2","ha2","debug","auth_params","Error","push","join"],"sources":["/app/node_modules/jssip/lib-es5/DigestAuthentication.js"],"sourcesContent":["\"use strict\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Logger = require('./Logger');\n\nvar Utils = require('./Utils');\n\nvar logger = new Logger('DigestAuthentication');\n\nmodule.exports = /*#__PURE__*/function () {\n  function DigestAuthentication(credentials) {\n    _classCallCheck(this, DigestAuthentication);\n\n    this._credentials = credentials;\n    this._cnonce = null;\n    this._nc = 0;\n    this._ncHex = '00000000';\n    this._algorithm = null;\n    this._realm = null;\n    this._nonce = null;\n    this._opaque = null;\n    this._stale = null;\n    this._qop = null;\n    this._method = null;\n    this._uri = null;\n    this._ha1 = null;\n    this._response = null;\n  }\n\n  _createClass(DigestAuthentication, [{\n    key: \"get\",\n    value: function get(parameter) {\n      switch (parameter) {\n        case 'realm':\n          return this._realm;\n\n        case 'ha1':\n          return this._ha1;\n\n        default:\n          logger.warn('get() | cannot get \"%s\" parameter', parameter);\n          return undefined;\n      }\n    }\n    /**\n    * Performs Digest authentication given a SIP request and the challenge\n    * received in a response to that request.\n    * Returns true if auth was successfully generated, false otherwise.\n    */\n\n  }, {\n    key: \"authenticate\",\n    value: function authenticate(_ref, challenge)\n    /* test interface */\n    {\n      var method = _ref.method,\n          ruri = _ref.ruri,\n          body = _ref.body;\n      var cnonce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      this._algorithm = challenge.algorithm;\n      this._realm = challenge.realm;\n      this._nonce = challenge.nonce;\n      this._opaque = challenge.opaque;\n      this._stale = challenge.stale;\n\n      if (this._algorithm) {\n        if (this._algorithm !== 'MD5') {\n          logger.warn('authenticate() | challenge with Digest algorithm different than \"MD5\", authentication aborted');\n          return false;\n        }\n      } else {\n        this._algorithm = 'MD5';\n      }\n\n      if (!this._nonce) {\n        logger.warn('authenticate() | challenge without Digest nonce, authentication aborted');\n        return false;\n      }\n\n      if (!this._realm) {\n        logger.warn('authenticate() | challenge without Digest realm, authentication aborted');\n        return false;\n      } // If no plain SIP password is provided.\n\n\n      if (!this._credentials.password) {\n        // If ha1 is not provided we cannot authenticate.\n        if (!this._credentials.ha1) {\n          logger.warn('authenticate() | no plain SIP password nor ha1 provided, authentication aborted');\n          return false;\n        } // If the realm does not match the stored realm we cannot authenticate.\n\n\n        if (this._credentials.realm !== this._realm) {\n          logger.warn('authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:\"%s\", given:\"%s\"]', this._credentials.realm, this._realm);\n          return false;\n        }\n      } // 'qop' can contain a list of values (Array). Let's choose just one.\n\n\n      if (challenge.qop) {\n        if (challenge.qop.indexOf('auth-int') > -1) {\n          this._qop = 'auth-int';\n        } else if (challenge.qop.indexOf('auth') > -1) {\n          this._qop = 'auth';\n        } else {\n          // Otherwise 'qop' is present but does not contain 'auth' or 'auth-int', so abort here.\n          logger.warn('authenticate() | challenge without Digest qop different than \"auth\" or \"auth-int\", authentication aborted');\n          return false;\n        }\n      } else {\n        this._qop = null;\n      } // Fill other attributes.\n\n\n      this._method = method;\n      this._uri = ruri;\n      this._cnonce = cnonce || Utils.createRandomToken(12);\n      this._nc += 1;\n      var hex = Number(this._nc).toString(16);\n      this._ncHex = '00000000'.substr(0, 8 - hex.length) + hex; // Nc-value = 8LHEX. Max value = 'FFFFFFFF'.\n\n      if (this._nc === 4294967296) {\n        this._nc = 1;\n        this._ncHex = '00000001';\n      } // Calculate the Digest \"response\" value.\n      // If we have plain SIP password then regenerate ha1.\n\n\n      if (this._credentials.password) {\n        // HA1 = MD5(A1) = MD5(username:realm:password).\n        this._ha1 = Utils.calculateMD5(\"\".concat(this._credentials.username, \":\").concat(this._realm, \":\").concat(this._credentials.password));\n      } // Otherwise reuse the stored ha1.\n      else {\n          this._ha1 = this._credentials.ha1;\n        }\n\n      var a2;\n      var ha2;\n\n      if (this._qop === 'auth') {\n        // HA2 = MD5(A2) = MD5(method:digestURI).\n        a2 = \"\".concat(this._method, \":\").concat(this._uri);\n        ha2 = Utils.calculateMD5(a2);\n        logger.debug('authenticate() | using qop=auth [a2:\"%s\"]', a2); // Response = MD5(HA1:nonce:nonceCount:credentialsNonce:qop:HA2).\n\n        this._response = Utils.calculateMD5(\"\".concat(this._ha1, \":\").concat(this._nonce, \":\").concat(this._ncHex, \":\").concat(this._cnonce, \":auth:\").concat(ha2));\n      } else if (this._qop === 'auth-int') {\n        // HA2 = MD5(A2) = MD5(method:digestURI:MD5(entityBody)).\n        a2 = \"\".concat(this._method, \":\").concat(this._uri, \":\").concat(Utils.calculateMD5(body ? body : ''));\n        ha2 = Utils.calculateMD5(a2);\n        logger.debug('authenticate() | using qop=auth-int [a2:\"%s\"]', a2); // Response = MD5(HA1:nonce:nonceCount:credentialsNonce:qop:HA2).\n\n        this._response = Utils.calculateMD5(\"\".concat(this._ha1, \":\").concat(this._nonce, \":\").concat(this._ncHex, \":\").concat(this._cnonce, \":auth-int:\").concat(ha2));\n      } else if (this._qop === null) {\n        // HA2 = MD5(A2) = MD5(method:digestURI).\n        a2 = \"\".concat(this._method, \":\").concat(this._uri);\n        ha2 = Utils.calculateMD5(a2);\n        logger.debug('authenticate() | using qop=null [a2:\"%s\"]', a2); // Response = MD5(HA1:nonce:HA2).\n\n        this._response = Utils.calculateMD5(\"\".concat(this._ha1, \":\").concat(this._nonce, \":\").concat(ha2));\n      }\n\n      logger.debug('authenticate() | response generated');\n      return true;\n    }\n    /**\n    * Return the Proxy-Authorization or WWW-Authorization header value.\n    */\n\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      var auth_params = [];\n\n      if (!this._response) {\n        throw new Error('response field does not exist, cannot generate Authorization header');\n      }\n\n      auth_params.push(\"algorithm=\".concat(this._algorithm));\n      auth_params.push(\"username=\\\"\".concat(this._credentials.username, \"\\\"\"));\n      auth_params.push(\"realm=\\\"\".concat(this._realm, \"\\\"\"));\n      auth_params.push(\"nonce=\\\"\".concat(this._nonce, \"\\\"\"));\n      auth_params.push(\"uri=\\\"\".concat(this._uri, \"\\\"\"));\n      auth_params.push(\"response=\\\"\".concat(this._response, \"\\\"\"));\n\n      if (this._opaque) {\n        auth_params.push(\"opaque=\\\"\".concat(this._opaque, \"\\\"\"));\n      }\n\n      if (this._qop) {\n        auth_params.push(\"qop=\".concat(this._qop));\n        auth_params.push(\"cnonce=\\\"\".concat(this._cnonce, \"\\\"\"));\n        auth_params.push(\"nc=\".concat(this._ncHex));\n      }\n\n      return \"Digest \".concat(auth_params.join(', '));\n    }\n  }]);\n\n  return DigestAuthentication;\n}();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}