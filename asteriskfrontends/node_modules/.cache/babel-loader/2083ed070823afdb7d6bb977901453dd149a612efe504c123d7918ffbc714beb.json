{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n  return _assertThisInitialized(self);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nvar EventEmitter = require('events').EventEmitter;\nvar Logger = require('./Logger');\nvar JsSIP_C = require('./Constants');\nvar Registrator = require('./Registrator');\nvar RTCSession = require('./RTCSession');\nvar Message = require('./Message');\nvar Options = require('./Options');\nvar Transactions = require('./Transactions');\nvar Transport = require('./Transport');\nvar Utils = require('./Utils');\nvar Exceptions = require('./Exceptions');\nvar URI = require('./URI');\nvar Parser = require('./Parser');\nvar SIPMessage = require('./SIPMessage');\nvar sanityCheck = require('./sanityCheck');\nvar config = require('./Config');\nvar logger = new Logger('UA');\nvar C = {\n  // UA status codes.\n  STATUS_INIT: 0,\n  STATUS_READY: 1,\n  STATUS_USER_CLOSED: 2,\n  STATUS_NOT_READY: 3,\n  // UA error codes.\n  CONFIGURATION_ERROR: 1,\n  NETWORK_ERROR: 2\n};\n/**\n * The User-Agent class.\n * @class JsSIP.UA\n * @param {Object} configuration Configuration parameters.\n * @throws {JsSIP.Exceptions.ConfigurationError} If a configuration parameter is invalid.\n * @throws {TypeError} If no configuration is given.\n */\n\nmodule.exports = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(UA, _EventEmitter);\n  var _super = _createSuper(UA);\n  _createClass(UA, null, [{\n    key: \"C\",\n    // Expose C object.\n    get: function get() {\n      return C;\n    }\n  }]);\n  function UA(configuration) {\n    var _this;\n    _classCallCheck(this, UA);\n    logger.debug('new() [configuration:%o]', configuration);\n    _this = _super.call(this);\n    _this._cache = {\n      credentials: {}\n    };\n    _this._configuration = Object.assign({}, config.settings);\n    _this._dynConfiguration = {};\n    _this._dialogs = {}; // User actions outside any session/dialog (MESSAGE/OPTIONS).\n\n    _this._applicants = {};\n    _this._sessions = {};\n    _this._transport = null;\n    _this._contact = null;\n    _this._status = C.STATUS_INIT;\n    _this._error = null;\n    _this._transactions = {\n      nist: {},\n      nict: {},\n      ist: {},\n      ict: {}\n    }; // Custom UA empty object for high level use.\n\n    _this._data = {};\n    _this._closeTimer = null; // Check configuration argument.\n\n    if (configuration === undefined) {\n      throw new TypeError('Not enough arguments');\n    } // Load configuration.\n\n    try {\n      _this._loadConfig(configuration);\n    } catch (e) {\n      _this._status = C.STATUS_NOT_READY;\n      _this._error = C.CONFIGURATION_ERROR;\n      throw e;\n    } // Initialize registrator.\n\n    _this._registrator = new Registrator(_assertThisInitialized(_this));\n    return _this;\n  }\n  _createClass(UA, [{\n    key: \"start\",\n    // =================\n    //  High Level API\n    // =================\n\n    /**\n     * Connect to the server if status = STATUS_INIT.\n     * Resume UA after being closed.\n     */\n    value: function start() {\n      logger.debug('start()');\n      if (this._status === C.STATUS_INIT) {\n        this._transport.connect();\n      } else if (this._status === C.STATUS_USER_CLOSED) {\n        logger.debug('restarting UA'); // Disconnect.\n\n        if (this._closeTimer !== null) {\n          clearTimeout(this._closeTimer);\n          this._closeTimer = null;\n          this._transport.disconnect();\n        } // Reconnect.\n\n        this._status = C.STATUS_INIT;\n        this._transport.connect();\n      } else if (this._status === C.STATUS_READY) {\n        logger.debug('UA is in READY status, not restarted');\n      } else {\n        logger.debug('ERROR: connection is down, Auto-Recovery system is trying to reconnect');\n      } // Set dynamic configuration.\n\n      this._dynConfiguration.register = this._configuration.register;\n    }\n    /**\n     * Register.\n     */\n  }, {\n    key: \"register\",\n    value: function register() {\n      logger.debug('register()');\n      this._dynConfiguration.register = true;\n      this._registrator.register();\n    }\n    /**\n     * Unregister.\n     */\n  }, {\n    key: \"unregister\",\n    value: function unregister(options) {\n      logger.debug('unregister()');\n      this._dynConfiguration.register = false;\n      this._registrator.unregister(options);\n    }\n    /**\n     * Get the Registrator instance.\n     */\n  }, {\n    key: \"registrator\",\n    value: function registrator() {\n      return this._registrator;\n    }\n    /**\n     * Registration state.\n     */\n  }, {\n    key: \"isRegistered\",\n    value: function isRegistered() {\n      return this._registrator.registered;\n    }\n    /**\n     * Connection state.\n     */\n  }, {\n    key: \"isConnected\",\n    value: function isConnected() {\n      return this._transport.isConnected();\n    }\n    /**\n     * Make an outgoing call.\n     *\n     * -param {String} target\n     * -param {Object} [options]\n     *\n     * -throws {TypeError}\n     *\n     */\n  }, {\n    key: \"call\",\n    value: function call(target, options) {\n      logger.debug('call()');\n      var session = new RTCSession(this);\n      session.connect(target, options);\n      return session;\n    }\n    /**\n     * Send a message.\n     *\n     * -param {String} target\n     * -param {String} body\n     * -param {Object} [options]\n     *\n     * -throws {TypeError}\n     *\n     */\n  }, {\n    key: \"sendMessage\",\n    value: function sendMessage(target, body, options) {\n      logger.debug('sendMessage()');\n      var message = new Message(this);\n      message.send(target, body, options);\n      return message;\n    }\n    /**\n     * Send a SIP OPTIONS.\n     *\n     * -param {String} target\n     * -param {String} [body]\n     * -param {Object} [options]\n     *\n     * -throws {TypeError}\n     *\n     */\n  }, {\n    key: \"sendOptions\",\n    value: function sendOptions(target, body, options) {\n      logger.debug('sendOptions()');\n      var message = new Options(this);\n      message.send(target, body, options);\n      return message;\n    }\n    /**\n     * Terminate ongoing sessions.\n     */\n  }, {\n    key: \"terminateSessions\",\n    value: function terminateSessions(options) {\n      logger.debug('terminateSessions()');\n      for (var idx in this._sessions) {\n        if (!this._sessions[idx].isEnded()) {\n          this._sessions[idx].terminate(options);\n        }\n      }\n    }\n    /**\n     * Gracefully close.\n     *\n     */\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      var _this2 = this;\n      logger.debug('stop()'); // Remove dynamic settings.\n\n      this._dynConfiguration = {};\n      if (this._status === C.STATUS_USER_CLOSED) {\n        logger.debug('UA already closed');\n        return;\n      } // Close registrator.\n\n      this._registrator.close(); // If there are session wait a bit so CANCEL/BYE can be sent and their responses received.\n\n      var num_sessions = Object.keys(this._sessions).length; // Run  _terminate_ on every Session.\n\n      for (var session in this._sessions) {\n        if (Object.prototype.hasOwnProperty.call(this._sessions, session)) {\n          logger.debug(\"closing session \".concat(session));\n          try {\n            this._sessions[session].terminate();\n          } catch (error) {}\n        }\n      } // Run  _close_ on every applicant.\n\n      for (var applicant in this._applicants) {\n        if (Object.prototype.hasOwnProperty.call(this._applicants, applicant)) try {\n          this._applicants[applicant].close();\n        } catch (error) {}\n      }\n      this._status = C.STATUS_USER_CLOSED;\n      var num_transactions = Object.keys(this._transactions.nict).length + Object.keys(this._transactions.nist).length + Object.keys(this._transactions.ict).length + Object.keys(this._transactions.ist).length;\n      if (num_transactions === 0 && num_sessions === 0) {\n        this._transport.disconnect();\n      } else {\n        this._closeTimer = setTimeout(function () {\n          _this2._closeTimer = null;\n          _this2._transport.disconnect();\n        }, 2000);\n      }\n    }\n    /**\n     * Normalice a string into a valid SIP request URI\n     * -param {String} target\n     * -returns {JsSIP.URI|undefined}\n     */\n  }, {\n    key: \"normalizeTarget\",\n    value: function normalizeTarget(target) {\n      return Utils.normalizeTarget(target, this._configuration.hostport_params);\n    }\n    /**\n     * Allow retrieving configuration and autogenerated fields in runtime.\n     */\n  }, {\n    key: \"get\",\n    value: function get(parameter) {\n      switch (parameter) {\n        case 'authorization_user':\n          return this._configuration.authorization_user;\n        case 'realm':\n          return this._configuration.realm;\n        case 'ha1':\n          return this._configuration.ha1;\n        case 'authorization_jwt':\n          return this._configuration.authorization_jwt;\n        default:\n          logger.warn('get() | cannot get \"%s\" parameter in runtime', parameter);\n          return undefined;\n      }\n    }\n    /**\n     * Allow configuration changes in runtime.\n     * Returns true if the parameter could be set.\n     */\n  }, {\n    key: \"set\",\n    value: function set(parameter, value) {\n      switch (parameter) {\n        case 'authorization_user':\n          {\n            this._configuration.authorization_user = String(value);\n            break;\n          }\n        case 'password':\n          {\n            this._configuration.password = String(value);\n            break;\n          }\n        case 'realm':\n          {\n            this._configuration.realm = String(value);\n            break;\n          }\n        case 'ha1':\n          {\n            this._configuration.ha1 = String(value); // Delete the plain SIP password.\n\n            this._configuration.password = null;\n            break;\n          }\n        case 'authorization_jwt':\n          {\n            this._configuration.authorization_jwt = String(value);\n            break;\n          }\n        case 'display_name':\n          {\n            this._configuration.display_name = value;\n            break;\n          }\n        case 'extra_headers':\n          {\n            this._configuration.extra_headers = value;\n            break;\n          }\n        default:\n          logger.warn('set() | cannot set \"%s\" parameter in runtime', parameter);\n          return false;\n      }\n      return true;\n    } // ==========================\n    // Event Handlers.\n    // ==========================\n\n    /**\n     * new Transaction\n     */\n  }, {\n    key: \"newTransaction\",\n    value: function newTransaction(transaction) {\n      this._transactions[transaction.type][transaction.id] = transaction;\n      this.emit('newTransaction', {\n        transaction: transaction\n      });\n    }\n    /**\n     * Transaction destroyed.\n     */\n  }, {\n    key: \"destroyTransaction\",\n    value: function destroyTransaction(transaction) {\n      delete this._transactions[transaction.type][transaction.id];\n      this.emit('transactionDestroyed', {\n        transaction: transaction\n      });\n    }\n    /**\n     * new Dialog\n     */\n  }, {\n    key: \"newDialog\",\n    value: function newDialog(dialog) {\n      this._dialogs[dialog.id] = dialog;\n    }\n    /**\n     * Dialog destroyed.\n     */\n  }, {\n    key: \"destroyDialog\",\n    value: function destroyDialog(dialog) {\n      delete this._dialogs[dialog.id];\n    }\n    /**\n     *  new Message\n     */\n  }, {\n    key: \"newMessage\",\n    value: function newMessage(message, data) {\n      this._applicants[message] = message;\n      this.emit('newMessage', data);\n    }\n    /**\n     *  new Options\n     */\n  }, {\n    key: \"newOptions\",\n    value: function newOptions(message, data) {\n      this._applicants[message] = message;\n      this.emit('newOptions', data);\n    }\n    /**\n     *  Message destroyed.\n     */\n  }, {\n    key: \"destroyMessage\",\n    value: function destroyMessage(message) {\n      delete this._applicants[message];\n    }\n    /**\n     * new RTCSession\n     */\n  }, {\n    key: \"newRTCSession\",\n    value: function newRTCSession(session, data) {\n      this._sessions[session.id] = session;\n      this.emit('newRTCSession', data);\n    }\n    /**\n     * RTCSession destroyed.\n     */\n  }, {\n    key: \"destroyRTCSession\",\n    value: function destroyRTCSession(session) {\n      delete this._sessions[session.id];\n    }\n    /**\n     * Registered\n     */\n  }, {\n    key: \"registered\",\n    value: function registered(data) {\n      this.emit('registered', data);\n    }\n    /**\n     * Unregistered\n     */\n  }, {\n    key: \"unregistered\",\n    value: function unregistered(data) {\n      this.emit('unregistered', data);\n    }\n    /**\n     * Registration Failed\n     */\n  }, {\n    key: \"registrationFailed\",\n    value: function registrationFailed(data) {\n      this.emit('registrationFailed', data);\n    } // =========================\n    // ReceiveRequest.\n    // =========================\n\n    /**\n     * Request reception\n     */\n  }, {\n    key: \"receiveRequest\",\n    value: function receiveRequest(request) {\n      var method = request.method; // Check that request URI points to us.\n\n      if (request.ruri.user !== this._configuration.uri.user && request.ruri.user !== this._contact.uri.user) {\n        logger.debug('Request-URI does not point to us');\n        if (request.method !== JsSIP_C.ACK) {\n          request.reply_sl(404);\n        }\n        return;\n      } // Check request URI scheme.\n\n      if (request.ruri.scheme === JsSIP_C.SIPS) {\n        request.reply_sl(416);\n        return;\n      } // Check transaction.\n\n      if (Transactions.checkTransaction(this, request)) {\n        return;\n      } // Create the server transaction.\n\n      if (method === JsSIP_C.INVITE) {\n        /* eslint-disable no-new */\n        new Transactions.InviteServerTransaction(this, this._transport, request);\n        /* eslint-enable no-new */\n      } else if (method !== JsSIP_C.ACK && method !== JsSIP_C.CANCEL) {\n        /* eslint-disable no-new */\n        new Transactions.NonInviteServerTransaction(this, this._transport, request);\n        /* eslint-enable no-new */\n      }\n      /* RFC3261 12.2.2\n       * Requests that do not change in any way the state of a dialog may be\n       * received within a dialog (for example, an OPTIONS request).\n       * They are processed as if they had been received outside the dialog.\n       */\n\n      if (method === JsSIP_C.OPTIONS) {\n        if (this.listeners('newOptions').length === 0) {\n          request.reply(200);\n          return;\n        }\n        var message = new Options(this);\n        message.init_incoming(request);\n      } else if (method === JsSIP_C.MESSAGE) {\n        if (this.listeners('newMessage').length === 0) {\n          request.reply(405);\n          return;\n        }\n        var _message = new Message(this);\n        _message.init_incoming(request);\n      } else if (method === JsSIP_C.INVITE) {\n        // Initial INVITE.\n        if (!request.to_tag && this.listeners('newRTCSession').length === 0) {\n          request.reply(405);\n          return;\n        }\n      }\n      var dialog;\n      var session; // Initial Request.\n\n      if (!request.to_tag) {\n        switch (method) {\n          case JsSIP_C.INVITE:\n            if (window.RTCPeerConnection) {\n              // TODO\n              if (request.hasHeader('replaces')) {\n                var replaces = request.replaces;\n                dialog = this._findDialog(replaces.call_id, replaces.from_tag, replaces.to_tag);\n                if (dialog) {\n                  session = dialog.owner;\n                  if (!session.isEnded()) {\n                    session.receiveRequest(request);\n                  } else {\n                    request.reply(603);\n                  }\n                } else {\n                  request.reply(481);\n                }\n              } else {\n                session = new RTCSession(this);\n                session.init_incoming(request);\n              }\n            } else {\n              logger.warn('INVITE received but WebRTC is not supported');\n              request.reply(488);\n            }\n            break;\n          case JsSIP_C.BYE:\n            // Out of dialog BYE received.\n            request.reply(481);\n            break;\n          case JsSIP_C.CANCEL:\n            session = this._findSession(request);\n            if (session) {\n              session.receiveRequest(request);\n            } else {\n              logger.debug('received CANCEL request for a non existent session');\n            }\n            break;\n          case JsSIP_C.ACK:\n            /* Absorb it.\n             * ACK request without a corresponding Invite Transaction\n             * and without To tag.\n             */\n            break;\n          case JsSIP_C.NOTIFY:\n            // Receive new sip event.\n            this.emit('sipEvent', {\n              event: request.event,\n              request: request\n            });\n            request.reply(200);\n            break;\n          default:\n            request.reply(405);\n            break;\n        }\n      } // In-dialog request.\n      else {\n        dialog = this._findDialog(request.call_id, request.from_tag, request.to_tag);\n        if (dialog) {\n          dialog.receiveRequest(request);\n        } else if (method === JsSIP_C.NOTIFY) {\n          session = this._findSession(request);\n          if (session) {\n            session.receiveRequest(request);\n          } else {\n            logger.debug('received NOTIFY request for a non existent subscription');\n            request.reply(481, 'Subscription does not exist');\n          }\n        }\n        /* RFC3261 12.2.2\n         * Request with to tag, but no matching dialog found.\n         * Exception: ACK for an Invite request for which a dialog has not\n         * been created.\n         */else if (method !== JsSIP_C.ACK) {\n          request.reply(481);\n        }\n      }\n    } // =================\n    // Utils.\n    // =================\n\n    /**\n     * Get the session to which the request belongs to, if any.\n     */\n  }, {\n    key: \"_findSession\",\n    value: function _findSession(_ref) {\n      var call_id = _ref.call_id,\n        from_tag = _ref.from_tag,\n        to_tag = _ref.to_tag;\n      var sessionIDa = call_id + from_tag;\n      var sessionA = this._sessions[sessionIDa];\n      var sessionIDb = call_id + to_tag;\n      var sessionB = this._sessions[sessionIDb];\n      if (sessionA) {\n        return sessionA;\n      } else if (sessionB) {\n        return sessionB;\n      } else {\n        return null;\n      }\n    }\n    /**\n     * Get the dialog to which the request belongs to, if any.\n     */\n  }, {\n    key: \"_findDialog\",\n    value: function _findDialog(call_id, from_tag, to_tag) {\n      var id = call_id + from_tag + to_tag;\n      var dialog = this._dialogs[id];\n      if (dialog) {\n        return dialog;\n      } else {\n        id = call_id + to_tag + from_tag;\n        dialog = this._dialogs[id];\n        if (dialog) {\n          return dialog;\n        } else {\n          return null;\n        }\n      }\n    }\n  }, {\n    key: \"_loadConfig\",\n    value: function _loadConfig(configuration) {\n      // Check and load the given configuration.\n      try {\n        config.load(this._configuration, configuration);\n      } catch (e) {\n        throw e;\n      } // Post Configuration Process.\n      // Allow passing 0 number as display_name.\n\n      if (this._configuration.display_name === 0) {\n        this._configuration.display_name = '0';\n      } // Instance-id for GRUU.\n\n      if (!this._configuration.instance_id) {\n        this._configuration.instance_id = Utils.newUUID();\n      } // Jssip_id instance parameter. Static random tag of length 5.\n\n      this._configuration.jssip_id = Utils.createRandomToken(5); // String containing this._configuration.uri without scheme and user.\n\n      var hostport_params = this._configuration.uri.clone();\n      hostport_params.user = null;\n      this._configuration.hostport_params = hostport_params.toString().replace(/^sip:/i, ''); // Transport.\n\n      try {\n        this._transport = new Transport(this._configuration.sockets, {\n          // Recovery options.\n          max_interval: this._configuration.connection_recovery_max_interval,\n          min_interval: this._configuration.connection_recovery_min_interval\n        }); // Transport event callbacks.\n\n        this._transport.onconnecting = onTransportConnecting.bind(this);\n        this._transport.onconnect = onTransportConnect.bind(this);\n        this._transport.ondisconnect = onTransportDisconnect.bind(this);\n        this._transport.ondata = onTransportData.bind(this);\n      } catch (e) {\n        logger.warn(e);\n        throw new Exceptions.ConfigurationError('sockets', this._configuration.sockets);\n      } // Remove sockets instance from configuration object.\n\n      delete this._configuration.sockets; // Check whether authorization_user is explicitly defined.\n      // Take 'this._configuration.uri.user' value if not.\n\n      if (!this._configuration.authorization_user) {\n        this._configuration.authorization_user = this._configuration.uri.user;\n      } // If no 'registrar_server' is set use the 'uri' value without user portion and\n      // without URI params/headers.\n\n      if (!this._configuration.registrar_server) {\n        var registrar_server = this._configuration.uri.clone();\n        registrar_server.user = null;\n        registrar_server.clearParams();\n        registrar_server.clearHeaders();\n        this._configuration.registrar_server = registrar_server;\n      } // User no_answer_timeout.\n\n      this._configuration.no_answer_timeout *= 1000; // Via Host.\n\n      if (this._configuration.contact_uri) {\n        this._configuration.via_host = this._configuration.contact_uri.host;\n      } // Contact URI.\n      else {\n        this._configuration.contact_uri = new URI('sip', Utils.createRandomToken(8), this._configuration.via_host, null, {\n          transport: 'ws'\n        });\n      }\n      this._contact = {\n        pub_gruu: null,\n        temp_gruu: null,\n        uri: this._configuration.contact_uri,\n        toString: function toString() {\n          var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n          var anonymous = options.anonymous || null;\n          var outbound = options.outbound || null;\n          var contact = '<';\n          if (anonymous) {\n            contact += this.temp_gruu || 'sip:anonymous@anonymous.invalid;transport=ws';\n          } else {\n            contact += this.pub_gruu || this.uri.toString();\n          }\n          if (outbound && (anonymous ? !this.temp_gruu : !this.pub_gruu)) {\n            contact += ';ob';\n          }\n          contact += '>';\n          return contact;\n        }\n      }; // Seal the configuration.\n\n      var writable_parameters = ['authorization_user', 'password', 'realm', 'ha1', 'authorization_jwt', 'display_name', 'register', 'extra_headers'];\n      for (var parameter in this._configuration) {\n        if (Object.prototype.hasOwnProperty.call(this._configuration, parameter)) {\n          if (writable_parameters.indexOf(parameter) !== -1) {\n            Object.defineProperty(this._configuration, parameter, {\n              writable: true,\n              configurable: false\n            });\n          } else {\n            Object.defineProperty(this._configuration, parameter, {\n              writable: false,\n              configurable: false\n            });\n          }\n        }\n      }\n      logger.debug('configuration parameters after validation:');\n      for (var _parameter in this._configuration) {\n        // Only show the user user configurable parameters.\n        if (Object.prototype.hasOwnProperty.call(config.settings, _parameter)) {\n          switch (_parameter) {\n            case 'uri':\n            case 'registrar_server':\n              logger.debug(\"- \".concat(_parameter, \": \").concat(this._configuration[_parameter]));\n              break;\n            case 'password':\n            case 'ha1':\n            case 'authorization_jwt':\n              logger.debug(\"- \".concat(_parameter, \": NOT SHOWN\"));\n              break;\n            default:\n              logger.debug(\"- \".concat(_parameter, \": \").concat(JSON.stringify(this._configuration[_parameter])));\n          }\n        }\n      }\n      return;\n    }\n  }, {\n    key: \"C\",\n    get: function get() {\n      return C;\n    }\n  }, {\n    key: \"status\",\n    get: function get() {\n      return this._status;\n    }\n  }, {\n    key: \"contact\",\n    get: function get() {\n      return this._contact;\n    }\n  }, {\n    key: \"configuration\",\n    get: function get() {\n      return this._configuration;\n    }\n  }, {\n    key: \"transport\",\n    get: function get() {\n      return this._transport;\n    }\n  }]);\n  return UA;\n}(EventEmitter);\n/**\n * Transport event handlers\n */\n// Transport connecting event.\n\nfunction onTransportConnecting(data) {\n  this.emit('connecting', data);\n} // Transport connected event.\n\nfunction onTransportConnect(data) {\n  if (this._status === C.STATUS_USER_CLOSED) {\n    return;\n  }\n  this._status = C.STATUS_READY;\n  this._error = null;\n  this.emit('connected', data);\n  if (this._dynConfiguration.register) {\n    this._registrator.register();\n  }\n} // Transport disconnected event.\n\nfunction onTransportDisconnect(data) {\n  // Run _onTransportError_ callback on every client transaction using _transport_.\n  var client_transactions = ['nict', 'ict', 'nist', 'ist'];\n  for (var _i = 0, _client_transactions = client_transactions; _i < _client_transactions.length; _i++) {\n    var type = _client_transactions[_i];\n    for (var id in this._transactions[type]) {\n      if (Object.prototype.hasOwnProperty.call(this._transactions[type], id)) {\n        this._transactions[type][id].onTransportError();\n      }\n    }\n  }\n  this.emit('disconnected', data); // Call registrator _onTransportClosed_.\n\n  this._registrator.onTransportClosed();\n  if (this._status !== C.STATUS_USER_CLOSED) {\n    this._status = C.STATUS_NOT_READY;\n    this._error = C.NETWORK_ERROR;\n  }\n} // Transport data event.\n\nfunction onTransportData(data) {\n  var transport = data.transport;\n  var message = data.message;\n  message = Parser.parseMessage(message, this);\n  if (!message) {\n    return;\n  }\n  if (this._status === C.STATUS_USER_CLOSED && message instanceof SIPMessage.IncomingRequest) {\n    return;\n  } // Do some sanity check.\n\n  if (!sanityCheck(message, this, transport)) {\n    return;\n  }\n  if (message instanceof SIPMessage.IncomingRequest) {\n    message.transport = transport;\n    this.receiveRequest(message);\n  } else if (message instanceof SIPMessage.IncomingResponse) {\n    /* Unike stated in 18.1.2, if a response does not match\n    * any transaction, it is discarded here and no passed to the core\n    * in order to be discarded there.\n    */\n    var transaction;\n    switch (message.method) {\n      case JsSIP_C.INVITE:\n        transaction = this._transactions.ict[message.via_branch];\n        if (transaction) {\n          transaction.receiveResponse(message);\n        }\n        break;\n      case JsSIP_C.ACK:\n        // Just in case ;-).\n        break;\n      default:\n        transaction = this._transactions.nict[message.via_branch];\n        if (transaction) {\n          transaction.receiveResponse(message);\n        }\n        break;\n    }\n  }\n}","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","value","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","getPrototypeOf","EventEmitter","require","Logger","JsSIP_C","Registrator","RTCSession","Message","Options","Transactions","Transport","Utils","Exceptions","URI","Parser","SIPMessage","sanityCheck","config","logger","C","STATUS_INIT","STATUS_READY","STATUS_USER_CLOSED","STATUS_NOT_READY","CONFIGURATION_ERROR","NETWORK_ERROR","module","exports","_EventEmitter","UA","_super","get","configuration","_this","debug","_cache","credentials","_configuration","assign","settings","_dynConfiguration","_dialogs","_applicants","_sessions","_transport","_contact","_status","_error","_transactions","nist","nict","ist","ict","_data","_closeTimer","undefined","_loadConfig","_registrator","start","connect","clearTimeout","disconnect","register","unregister","options","registrator","isRegistered","registered","isConnected","session","sendMessage","body","message","send","sendOptions","terminateSessions","idx","isEnded","terminate","stop","_this2","close","num_sessions","keys","hasOwnProperty","concat","error","applicant","num_transactions","setTimeout","normalizeTarget","hostport_params","parameter","authorization_user","realm","ha1","authorization_jwt","warn","set","String","password","display_name","extra_headers","newTransaction","transaction","type","id","emit","destroyTransaction","newDialog","dialog","destroyDialog","newMessage","data","newOptions","destroyMessage","newRTCSession","destroyRTCSession","unregistered","registrationFailed","receiveRequest","request","method","ruri","user","uri","ACK","reply_sl","scheme","SIPS","checkTransaction","INVITE","InviteServerTransaction","CANCEL","NonInviteServerTransaction","OPTIONS","listeners","reply","init_incoming","MESSAGE","_message","to_tag","window","RTCPeerConnection","hasHeader","replaces","_findDialog","call_id","from_tag","owner","BYE","_findSession","NOTIFY","event","_ref","sessionIDa","sessionA","sessionIDb","sessionB","load","instance_id","newUUID","jssip_id","createRandomToken","clone","replace","sockets","max_interval","connection_recovery_max_interval","min_interval","connection_recovery_min_interval","onconnecting","onTransportConnecting","bind","onconnect","onTransportConnect","ondisconnect","onTransportDisconnect","ondata","onTransportData","ConfigurationError","registrar_server","clearParams","clearHeaders","no_answer_timeout","contact_uri","via_host","host","transport","pub_gruu","temp_gruu","anonymous","outbound","contact","writable_parameters","indexOf","_parameter","JSON","stringify","client_transactions","_i","_client_transactions","onTransportError","onTransportClosed","parseMessage","IncomingRequest","IncomingResponse","via_branch","receiveResponse"],"sources":["/app/node_modules/jssip/lib-es5/UA.js"],"sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar EventEmitter = require('events').EventEmitter;\n\nvar Logger = require('./Logger');\n\nvar JsSIP_C = require('./Constants');\n\nvar Registrator = require('./Registrator');\n\nvar RTCSession = require('./RTCSession');\n\nvar Message = require('./Message');\n\nvar Options = require('./Options');\n\nvar Transactions = require('./Transactions');\n\nvar Transport = require('./Transport');\n\nvar Utils = require('./Utils');\n\nvar Exceptions = require('./Exceptions');\n\nvar URI = require('./URI');\n\nvar Parser = require('./Parser');\n\nvar SIPMessage = require('./SIPMessage');\n\nvar sanityCheck = require('./sanityCheck');\n\nvar config = require('./Config');\n\nvar logger = new Logger('UA');\nvar C = {\n  // UA status codes.\n  STATUS_INIT: 0,\n  STATUS_READY: 1,\n  STATUS_USER_CLOSED: 2,\n  STATUS_NOT_READY: 3,\n  // UA error codes.\n  CONFIGURATION_ERROR: 1,\n  NETWORK_ERROR: 2\n};\n/**\n * The User-Agent class.\n * @class JsSIP.UA\n * @param {Object} configuration Configuration parameters.\n * @throws {JsSIP.Exceptions.ConfigurationError} If a configuration parameter is invalid.\n * @throws {TypeError} If no configuration is given.\n */\n\nmodule.exports = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(UA, _EventEmitter);\n\n  var _super = _createSuper(UA);\n\n  _createClass(UA, null, [{\n    key: \"C\",\n    // Expose C object.\n    get: function get() {\n      return C;\n    }\n  }]);\n\n  function UA(configuration) {\n    var _this;\n\n    _classCallCheck(this, UA);\n\n    logger.debug('new() [configuration:%o]', configuration);\n    _this = _super.call(this);\n    _this._cache = {\n      credentials: {}\n    };\n    _this._configuration = Object.assign({}, config.settings);\n    _this._dynConfiguration = {};\n    _this._dialogs = {}; // User actions outside any session/dialog (MESSAGE/OPTIONS).\n\n    _this._applicants = {};\n    _this._sessions = {};\n    _this._transport = null;\n    _this._contact = null;\n    _this._status = C.STATUS_INIT;\n    _this._error = null;\n    _this._transactions = {\n      nist: {},\n      nict: {},\n      ist: {},\n      ict: {}\n    }; // Custom UA empty object for high level use.\n\n    _this._data = {};\n    _this._closeTimer = null; // Check configuration argument.\n\n    if (configuration === undefined) {\n      throw new TypeError('Not enough arguments');\n    } // Load configuration.\n\n\n    try {\n      _this._loadConfig(configuration);\n    } catch (e) {\n      _this._status = C.STATUS_NOT_READY;\n      _this._error = C.CONFIGURATION_ERROR;\n      throw e;\n    } // Initialize registrator.\n\n\n    _this._registrator = new Registrator(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(UA, [{\n    key: \"start\",\n    // =================\n    //  High Level API\n    // =================\n\n    /**\n     * Connect to the server if status = STATUS_INIT.\n     * Resume UA after being closed.\n     */\n    value: function start() {\n      logger.debug('start()');\n\n      if (this._status === C.STATUS_INIT) {\n        this._transport.connect();\n      } else if (this._status === C.STATUS_USER_CLOSED) {\n        logger.debug('restarting UA'); // Disconnect.\n\n        if (this._closeTimer !== null) {\n          clearTimeout(this._closeTimer);\n          this._closeTimer = null;\n\n          this._transport.disconnect();\n        } // Reconnect.\n\n\n        this._status = C.STATUS_INIT;\n\n        this._transport.connect();\n      } else if (this._status === C.STATUS_READY) {\n        logger.debug('UA is in READY status, not restarted');\n      } else {\n        logger.debug('ERROR: connection is down, Auto-Recovery system is trying to reconnect');\n      } // Set dynamic configuration.\n\n\n      this._dynConfiguration.register = this._configuration.register;\n    }\n    /**\n     * Register.\n     */\n\n  }, {\n    key: \"register\",\n    value: function register() {\n      logger.debug('register()');\n      this._dynConfiguration.register = true;\n\n      this._registrator.register();\n    }\n    /**\n     * Unregister.\n     */\n\n  }, {\n    key: \"unregister\",\n    value: function unregister(options) {\n      logger.debug('unregister()');\n      this._dynConfiguration.register = false;\n\n      this._registrator.unregister(options);\n    }\n    /**\n     * Get the Registrator instance.\n     */\n\n  }, {\n    key: \"registrator\",\n    value: function registrator() {\n      return this._registrator;\n    }\n    /**\n     * Registration state.\n     */\n\n  }, {\n    key: \"isRegistered\",\n    value: function isRegistered() {\n      return this._registrator.registered;\n    }\n    /**\n     * Connection state.\n     */\n\n  }, {\n    key: \"isConnected\",\n    value: function isConnected() {\n      return this._transport.isConnected();\n    }\n    /**\n     * Make an outgoing call.\n     *\n     * -param {String} target\n     * -param {Object} [options]\n     *\n     * -throws {TypeError}\n     *\n     */\n\n  }, {\n    key: \"call\",\n    value: function call(target, options) {\n      logger.debug('call()');\n      var session = new RTCSession(this);\n      session.connect(target, options);\n      return session;\n    }\n    /**\n     * Send a message.\n     *\n     * -param {String} target\n     * -param {String} body\n     * -param {Object} [options]\n     *\n     * -throws {TypeError}\n     *\n     */\n\n  }, {\n    key: \"sendMessage\",\n    value: function sendMessage(target, body, options) {\n      logger.debug('sendMessage()');\n      var message = new Message(this);\n      message.send(target, body, options);\n      return message;\n    }\n    /**\n     * Send a SIP OPTIONS.\n     *\n     * -param {String} target\n     * -param {String} [body]\n     * -param {Object} [options]\n     *\n     * -throws {TypeError}\n     *\n     */\n\n  }, {\n    key: \"sendOptions\",\n    value: function sendOptions(target, body, options) {\n      logger.debug('sendOptions()');\n      var message = new Options(this);\n      message.send(target, body, options);\n      return message;\n    }\n    /**\n     * Terminate ongoing sessions.\n     */\n\n  }, {\n    key: \"terminateSessions\",\n    value: function terminateSessions(options) {\n      logger.debug('terminateSessions()');\n\n      for (var idx in this._sessions) {\n        if (!this._sessions[idx].isEnded()) {\n          this._sessions[idx].terminate(options);\n        }\n      }\n    }\n    /**\n     * Gracefully close.\n     *\n     */\n\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      var _this2 = this;\n\n      logger.debug('stop()'); // Remove dynamic settings.\n\n      this._dynConfiguration = {};\n\n      if (this._status === C.STATUS_USER_CLOSED) {\n        logger.debug('UA already closed');\n        return;\n      } // Close registrator.\n\n\n      this._registrator.close(); // If there are session wait a bit so CANCEL/BYE can be sent and their responses received.\n\n\n      var num_sessions = Object.keys(this._sessions).length; // Run  _terminate_ on every Session.\n\n      for (var session in this._sessions) {\n        if (Object.prototype.hasOwnProperty.call(this._sessions, session)) {\n          logger.debug(\"closing session \".concat(session));\n\n          try {\n            this._sessions[session].terminate();\n          } catch (error) {}\n        }\n      } // Run  _close_ on every applicant.\n\n\n      for (var applicant in this._applicants) {\n        if (Object.prototype.hasOwnProperty.call(this._applicants, applicant)) try {\n          this._applicants[applicant].close();\n        } catch (error) {}\n      }\n\n      this._status = C.STATUS_USER_CLOSED;\n      var num_transactions = Object.keys(this._transactions.nict).length + Object.keys(this._transactions.nist).length + Object.keys(this._transactions.ict).length + Object.keys(this._transactions.ist).length;\n\n      if (num_transactions === 0 && num_sessions === 0) {\n        this._transport.disconnect();\n      } else {\n        this._closeTimer = setTimeout(function () {\n          _this2._closeTimer = null;\n\n          _this2._transport.disconnect();\n        }, 2000);\n      }\n    }\n    /**\n     * Normalice a string into a valid SIP request URI\n     * -param {String} target\n     * -returns {JsSIP.URI|undefined}\n     */\n\n  }, {\n    key: \"normalizeTarget\",\n    value: function normalizeTarget(target) {\n      return Utils.normalizeTarget(target, this._configuration.hostport_params);\n    }\n    /**\n     * Allow retrieving configuration and autogenerated fields in runtime.\n     */\n\n  }, {\n    key: \"get\",\n    value: function get(parameter) {\n      switch (parameter) {\n        case 'authorization_user':\n          return this._configuration.authorization_user;\n\n        case 'realm':\n          return this._configuration.realm;\n\n        case 'ha1':\n          return this._configuration.ha1;\n\n        case 'authorization_jwt':\n          return this._configuration.authorization_jwt;\n\n        default:\n          logger.warn('get() | cannot get \"%s\" parameter in runtime', parameter);\n          return undefined;\n      }\n    }\n    /**\n     * Allow configuration changes in runtime.\n     * Returns true if the parameter could be set.\n     */\n\n  }, {\n    key: \"set\",\n    value: function set(parameter, value) {\n      switch (parameter) {\n        case 'authorization_user':\n          {\n            this._configuration.authorization_user = String(value);\n            break;\n          }\n\n        case 'password':\n          {\n            this._configuration.password = String(value);\n            break;\n          }\n\n        case 'realm':\n          {\n            this._configuration.realm = String(value);\n            break;\n          }\n\n        case 'ha1':\n          {\n            this._configuration.ha1 = String(value); // Delete the plain SIP password.\n\n            this._configuration.password = null;\n            break;\n          }\n\n        case 'authorization_jwt':\n          {\n            this._configuration.authorization_jwt = String(value);\n            break;\n          }\n\n        case 'display_name':\n          {\n            this._configuration.display_name = value;\n            break;\n          }\n\n        case 'extra_headers':\n          {\n            this._configuration.extra_headers = value;\n            break;\n          }\n\n        default:\n          logger.warn('set() | cannot set \"%s\" parameter in runtime', parameter);\n          return false;\n      }\n\n      return true;\n    } // ==========================\n    // Event Handlers.\n    // ==========================\n\n    /**\n     * new Transaction\n     */\n\n  }, {\n    key: \"newTransaction\",\n    value: function newTransaction(transaction) {\n      this._transactions[transaction.type][transaction.id] = transaction;\n      this.emit('newTransaction', {\n        transaction: transaction\n      });\n    }\n    /**\n     * Transaction destroyed.\n     */\n\n  }, {\n    key: \"destroyTransaction\",\n    value: function destroyTransaction(transaction) {\n      delete this._transactions[transaction.type][transaction.id];\n      this.emit('transactionDestroyed', {\n        transaction: transaction\n      });\n    }\n    /**\n     * new Dialog\n     */\n\n  }, {\n    key: \"newDialog\",\n    value: function newDialog(dialog) {\n      this._dialogs[dialog.id] = dialog;\n    }\n    /**\n     * Dialog destroyed.\n     */\n\n  }, {\n    key: \"destroyDialog\",\n    value: function destroyDialog(dialog) {\n      delete this._dialogs[dialog.id];\n    }\n    /**\n     *  new Message\n     */\n\n  }, {\n    key: \"newMessage\",\n    value: function newMessage(message, data) {\n      this._applicants[message] = message;\n      this.emit('newMessage', data);\n    }\n    /**\n     *  new Options\n     */\n\n  }, {\n    key: \"newOptions\",\n    value: function newOptions(message, data) {\n      this._applicants[message] = message;\n      this.emit('newOptions', data);\n    }\n    /**\n     *  Message destroyed.\n     */\n\n  }, {\n    key: \"destroyMessage\",\n    value: function destroyMessage(message) {\n      delete this._applicants[message];\n    }\n    /**\n     * new RTCSession\n     */\n\n  }, {\n    key: \"newRTCSession\",\n    value: function newRTCSession(session, data) {\n      this._sessions[session.id] = session;\n      this.emit('newRTCSession', data);\n    }\n    /**\n     * RTCSession destroyed.\n     */\n\n  }, {\n    key: \"destroyRTCSession\",\n    value: function destroyRTCSession(session) {\n      delete this._sessions[session.id];\n    }\n    /**\n     * Registered\n     */\n\n  }, {\n    key: \"registered\",\n    value: function registered(data) {\n      this.emit('registered', data);\n    }\n    /**\n     * Unregistered\n     */\n\n  }, {\n    key: \"unregistered\",\n    value: function unregistered(data) {\n      this.emit('unregistered', data);\n    }\n    /**\n     * Registration Failed\n     */\n\n  }, {\n    key: \"registrationFailed\",\n    value: function registrationFailed(data) {\n      this.emit('registrationFailed', data);\n    } // =========================\n    // ReceiveRequest.\n    // =========================\n\n    /**\n     * Request reception\n     */\n\n  }, {\n    key: \"receiveRequest\",\n    value: function receiveRequest(request) {\n      var method = request.method; // Check that request URI points to us.\n\n      if (request.ruri.user !== this._configuration.uri.user && request.ruri.user !== this._contact.uri.user) {\n        logger.debug('Request-URI does not point to us');\n\n        if (request.method !== JsSIP_C.ACK) {\n          request.reply_sl(404);\n        }\n\n        return;\n      } // Check request URI scheme.\n\n\n      if (request.ruri.scheme === JsSIP_C.SIPS) {\n        request.reply_sl(416);\n        return;\n      } // Check transaction.\n\n\n      if (Transactions.checkTransaction(this, request)) {\n        return;\n      } // Create the server transaction.\n\n\n      if (method === JsSIP_C.INVITE) {\n        /* eslint-disable no-new */\n        new Transactions.InviteServerTransaction(this, this._transport, request);\n        /* eslint-enable no-new */\n      } else if (method !== JsSIP_C.ACK && method !== JsSIP_C.CANCEL) {\n        /* eslint-disable no-new */\n        new Transactions.NonInviteServerTransaction(this, this._transport, request);\n        /* eslint-enable no-new */\n      }\n      /* RFC3261 12.2.2\n       * Requests that do not change in any way the state of a dialog may be\n       * received within a dialog (for example, an OPTIONS request).\n       * They are processed as if they had been received outside the dialog.\n       */\n\n\n      if (method === JsSIP_C.OPTIONS) {\n        if (this.listeners('newOptions').length === 0) {\n          request.reply(200);\n          return;\n        }\n\n        var message = new Options(this);\n        message.init_incoming(request);\n      } else if (method === JsSIP_C.MESSAGE) {\n        if (this.listeners('newMessage').length === 0) {\n          request.reply(405);\n          return;\n        }\n\n        var _message = new Message(this);\n\n        _message.init_incoming(request);\n      } else if (method === JsSIP_C.INVITE) {\n        // Initial INVITE.\n        if (!request.to_tag && this.listeners('newRTCSession').length === 0) {\n          request.reply(405);\n          return;\n        }\n      }\n\n      var dialog;\n      var session; // Initial Request.\n\n      if (!request.to_tag) {\n        switch (method) {\n          case JsSIP_C.INVITE:\n            if (window.RTCPeerConnection) {\n              // TODO\n              if (request.hasHeader('replaces')) {\n                var replaces = request.replaces;\n                dialog = this._findDialog(replaces.call_id, replaces.from_tag, replaces.to_tag);\n\n                if (dialog) {\n                  session = dialog.owner;\n\n                  if (!session.isEnded()) {\n                    session.receiveRequest(request);\n                  } else {\n                    request.reply(603);\n                  }\n                } else {\n                  request.reply(481);\n                }\n              } else {\n                session = new RTCSession(this);\n                session.init_incoming(request);\n              }\n            } else {\n              logger.warn('INVITE received but WebRTC is not supported');\n              request.reply(488);\n            }\n\n            break;\n\n          case JsSIP_C.BYE:\n            // Out of dialog BYE received.\n            request.reply(481);\n            break;\n\n          case JsSIP_C.CANCEL:\n            session = this._findSession(request);\n\n            if (session) {\n              session.receiveRequest(request);\n            } else {\n              logger.debug('received CANCEL request for a non existent session');\n            }\n\n            break;\n\n          case JsSIP_C.ACK:\n            /* Absorb it.\n             * ACK request without a corresponding Invite Transaction\n             * and without To tag.\n             */\n            break;\n\n          case JsSIP_C.NOTIFY:\n            // Receive new sip event.\n            this.emit('sipEvent', {\n              event: request.event,\n              request: request\n            });\n            request.reply(200);\n            break;\n\n          default:\n            request.reply(405);\n            break;\n        }\n      } // In-dialog request.\n      else {\n          dialog = this._findDialog(request.call_id, request.from_tag, request.to_tag);\n\n          if (dialog) {\n            dialog.receiveRequest(request);\n          } else if (method === JsSIP_C.NOTIFY) {\n            session = this._findSession(request);\n\n            if (session) {\n              session.receiveRequest(request);\n            } else {\n              logger.debug('received NOTIFY request for a non existent subscription');\n              request.reply(481, 'Subscription does not exist');\n            }\n          }\n          /* RFC3261 12.2.2\n           * Request with to tag, but no matching dialog found.\n           * Exception: ACK for an Invite request for which a dialog has not\n           * been created.\n           */\n          else if (method !== JsSIP_C.ACK) {\n              request.reply(481);\n            }\n        }\n    } // =================\n    // Utils.\n    // =================\n\n    /**\n     * Get the session to which the request belongs to, if any.\n     */\n\n  }, {\n    key: \"_findSession\",\n    value: function _findSession(_ref) {\n      var call_id = _ref.call_id,\n          from_tag = _ref.from_tag,\n          to_tag = _ref.to_tag;\n      var sessionIDa = call_id + from_tag;\n      var sessionA = this._sessions[sessionIDa];\n      var sessionIDb = call_id + to_tag;\n      var sessionB = this._sessions[sessionIDb];\n\n      if (sessionA) {\n        return sessionA;\n      } else if (sessionB) {\n        return sessionB;\n      } else {\n        return null;\n      }\n    }\n    /**\n     * Get the dialog to which the request belongs to, if any.\n     */\n\n  }, {\n    key: \"_findDialog\",\n    value: function _findDialog(call_id, from_tag, to_tag) {\n      var id = call_id + from_tag + to_tag;\n      var dialog = this._dialogs[id];\n\n      if (dialog) {\n        return dialog;\n      } else {\n        id = call_id + to_tag + from_tag;\n        dialog = this._dialogs[id];\n\n        if (dialog) {\n          return dialog;\n        } else {\n          return null;\n        }\n      }\n    }\n  }, {\n    key: \"_loadConfig\",\n    value: function _loadConfig(configuration) {\n      // Check and load the given configuration.\n      try {\n        config.load(this._configuration, configuration);\n      } catch (e) {\n        throw e;\n      } // Post Configuration Process.\n      // Allow passing 0 number as display_name.\n\n\n      if (this._configuration.display_name === 0) {\n        this._configuration.display_name = '0';\n      } // Instance-id for GRUU.\n\n\n      if (!this._configuration.instance_id) {\n        this._configuration.instance_id = Utils.newUUID();\n      } // Jssip_id instance parameter. Static random tag of length 5.\n\n\n      this._configuration.jssip_id = Utils.createRandomToken(5); // String containing this._configuration.uri without scheme and user.\n\n      var hostport_params = this._configuration.uri.clone();\n\n      hostport_params.user = null;\n      this._configuration.hostport_params = hostport_params.toString().replace(/^sip:/i, ''); // Transport.\n\n      try {\n        this._transport = new Transport(this._configuration.sockets, {\n          // Recovery options.\n          max_interval: this._configuration.connection_recovery_max_interval,\n          min_interval: this._configuration.connection_recovery_min_interval\n        }); // Transport event callbacks.\n\n        this._transport.onconnecting = onTransportConnecting.bind(this);\n        this._transport.onconnect = onTransportConnect.bind(this);\n        this._transport.ondisconnect = onTransportDisconnect.bind(this);\n        this._transport.ondata = onTransportData.bind(this);\n      } catch (e) {\n        logger.warn(e);\n        throw new Exceptions.ConfigurationError('sockets', this._configuration.sockets);\n      } // Remove sockets instance from configuration object.\n\n\n      delete this._configuration.sockets; // Check whether authorization_user is explicitly defined.\n      // Take 'this._configuration.uri.user' value if not.\n\n      if (!this._configuration.authorization_user) {\n        this._configuration.authorization_user = this._configuration.uri.user;\n      } // If no 'registrar_server' is set use the 'uri' value without user portion and\n      // without URI params/headers.\n\n\n      if (!this._configuration.registrar_server) {\n        var registrar_server = this._configuration.uri.clone();\n\n        registrar_server.user = null;\n        registrar_server.clearParams();\n        registrar_server.clearHeaders();\n        this._configuration.registrar_server = registrar_server;\n      } // User no_answer_timeout.\n\n\n      this._configuration.no_answer_timeout *= 1000; // Via Host.\n\n      if (this._configuration.contact_uri) {\n        this._configuration.via_host = this._configuration.contact_uri.host;\n      } // Contact URI.\n      else {\n          this._configuration.contact_uri = new URI('sip', Utils.createRandomToken(8), this._configuration.via_host, null, {\n            transport: 'ws'\n          });\n        }\n\n      this._contact = {\n        pub_gruu: null,\n        temp_gruu: null,\n        uri: this._configuration.contact_uri,\n        toString: function toString() {\n          var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n          var anonymous = options.anonymous || null;\n          var outbound = options.outbound || null;\n          var contact = '<';\n\n          if (anonymous) {\n            contact += this.temp_gruu || 'sip:anonymous@anonymous.invalid;transport=ws';\n          } else {\n            contact += this.pub_gruu || this.uri.toString();\n          }\n\n          if (outbound && (anonymous ? !this.temp_gruu : !this.pub_gruu)) {\n            contact += ';ob';\n          }\n\n          contact += '>';\n          return contact;\n        }\n      }; // Seal the configuration.\n\n      var writable_parameters = ['authorization_user', 'password', 'realm', 'ha1', 'authorization_jwt', 'display_name', 'register', 'extra_headers'];\n\n      for (var parameter in this._configuration) {\n        if (Object.prototype.hasOwnProperty.call(this._configuration, parameter)) {\n          if (writable_parameters.indexOf(parameter) !== -1) {\n            Object.defineProperty(this._configuration, parameter, {\n              writable: true,\n              configurable: false\n            });\n          } else {\n            Object.defineProperty(this._configuration, parameter, {\n              writable: false,\n              configurable: false\n            });\n          }\n        }\n      }\n\n      logger.debug('configuration parameters after validation:');\n\n      for (var _parameter in this._configuration) {\n        // Only show the user user configurable parameters.\n        if (Object.prototype.hasOwnProperty.call(config.settings, _parameter)) {\n          switch (_parameter) {\n            case 'uri':\n            case 'registrar_server':\n              logger.debug(\"- \".concat(_parameter, \": \").concat(this._configuration[_parameter]));\n              break;\n\n            case 'password':\n            case 'ha1':\n            case 'authorization_jwt':\n              logger.debug(\"- \".concat(_parameter, \": NOT SHOWN\"));\n              break;\n\n            default:\n              logger.debug(\"- \".concat(_parameter, \": \").concat(JSON.stringify(this._configuration[_parameter])));\n          }\n        }\n      }\n\n      return;\n    }\n  }, {\n    key: \"C\",\n    get: function get() {\n      return C;\n    }\n  }, {\n    key: \"status\",\n    get: function get() {\n      return this._status;\n    }\n  }, {\n    key: \"contact\",\n    get: function get() {\n      return this._contact;\n    }\n  }, {\n    key: \"configuration\",\n    get: function get() {\n      return this._configuration;\n    }\n  }, {\n    key: \"transport\",\n    get: function get() {\n      return this._transport;\n    }\n  }]);\n\n  return UA;\n}(EventEmitter);\n/**\n * Transport event handlers\n */\n// Transport connecting event.\n\n\nfunction onTransportConnecting(data) {\n  this.emit('connecting', data);\n} // Transport connected event.\n\n\nfunction onTransportConnect(data) {\n  if (this._status === C.STATUS_USER_CLOSED) {\n    return;\n  }\n\n  this._status = C.STATUS_READY;\n  this._error = null;\n  this.emit('connected', data);\n\n  if (this._dynConfiguration.register) {\n    this._registrator.register();\n  }\n} // Transport disconnected event.\n\n\nfunction onTransportDisconnect(data) {\n  // Run _onTransportError_ callback on every client transaction using _transport_.\n  var client_transactions = ['nict', 'ict', 'nist', 'ist'];\n\n  for (var _i = 0, _client_transactions = client_transactions; _i < _client_transactions.length; _i++) {\n    var type = _client_transactions[_i];\n\n    for (var id in this._transactions[type]) {\n      if (Object.prototype.hasOwnProperty.call(this._transactions[type], id)) {\n        this._transactions[type][id].onTransportError();\n      }\n    }\n  }\n\n  this.emit('disconnected', data); // Call registrator _onTransportClosed_.\n\n  this._registrator.onTransportClosed();\n\n  if (this._status !== C.STATUS_USER_CLOSED) {\n    this._status = C.STATUS_NOT_READY;\n    this._error = C.NETWORK_ERROR;\n  }\n} // Transport data event.\n\n\nfunction onTransportData(data) {\n  var transport = data.transport;\n  var message = data.message;\n  message = Parser.parseMessage(message, this);\n\n  if (!message) {\n    return;\n  }\n\n  if (this._status === C.STATUS_USER_CLOSED && message instanceof SIPMessage.IncomingRequest) {\n    return;\n  } // Do some sanity check.\n\n\n  if (!sanityCheck(message, this, transport)) {\n    return;\n  }\n\n  if (message instanceof SIPMessage.IncomingRequest) {\n    message.transport = transport;\n    this.receiveRequest(message);\n  } else if (message instanceof SIPMessage.IncomingResponse) {\n    /* Unike stated in 18.1.2, if a response does not match\n    * any transaction, it is discarded here and no passed to the core\n    * in order to be discarded there.\n    */\n    var transaction;\n\n    switch (message.method) {\n      case JsSIP_C.INVITE:\n        transaction = this._transactions.ict[message.via_branch];\n\n        if (transaction) {\n          transaction.receiveResponse(message);\n        }\n\n        break;\n\n      case JsSIP_C.ACK:\n        // Just in case ;-).\n        break;\n\n      default:\n        transaction = this._transactions.nict[message.via_branch];\n\n        if (transaction) {\n          transaction.receiveResponse(message);\n        }\n\n        break;\n    }\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}