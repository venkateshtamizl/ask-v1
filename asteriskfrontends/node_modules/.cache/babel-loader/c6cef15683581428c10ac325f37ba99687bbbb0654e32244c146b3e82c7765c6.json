{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n  return _assertThisInitialized(self);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n      var F = function F() {};\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var normalCompletion = true,\n    didErr = false,\n    err;\n  return {\n    s: function s() {\n      it = o[Symbol.iterator]();\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\nvar sdp_transform = require('sdp-transform');\nvar Logger = require('./Logger');\nvar JsSIP_C = require('./Constants');\nvar Utils = require('./Utils');\nvar NameAddrHeader = require('./NameAddrHeader');\nvar Grammar = require('./Grammar');\nvar logger = new Logger('SIPMessage');\n/**\n * -param {String} method request method\n * -param {String} ruri request uri\n * -param {UA} ua\n * -param {Object} params parameters that will have priority over ua.configuration parameters:\n * <br>\n *  - cseq, call_id, from_tag, from_uri, from_display_name, to_uri, to_tag, route_set\n * -param {Object} [headers] extra headers\n * -param {String} [body]\n */\n\nvar OutgoingRequest = /*#__PURE__*/function () {\n  function OutgoingRequest(method, ruri, ua, params, extraHeaders, body) {\n    _classCallCheck(this, OutgoingRequest);\n\n    // Mandatory parameters check.\n    if (!method || !ruri || !ua) {\n      return null;\n    }\n    params = params || {};\n    this.ua = ua;\n    this.headers = {};\n    this.method = method;\n    this.ruri = ruri;\n    this.body = body;\n    this.extraHeaders = Utils.cloneArray(extraHeaders);\n    if (this.ua.configuration.extra_headers) {\n      this.extraHeaders = this.extraHeaders.concat(this.ua.configuration.extra_headers);\n    } // Fill the Common SIP Request Headers.\n    // Route.\n\n    if (params.route_set) {\n      this.setHeader('route', params.route_set);\n    } else if (ua.configuration.use_preloaded_route) {\n      this.setHeader('route', \"<\".concat(ua.transport.sip_uri, \";lr>\"));\n    } // Via.\n    // Empty Via header. Will be filled by the client transaction.\n\n    this.setHeader('via', ''); // Max-Forwards.\n\n    this.setHeader('max-forwards', JsSIP_C.MAX_FORWARDS); // To\n\n    var to_uri = params.to_uri || ruri;\n    var to_params = params.to_tag ? {\n      tag: params.to_tag\n    } : null;\n    var to_display_name = typeof params.to_display_name !== 'undefined' ? params.to_display_name : null;\n    this.to = new NameAddrHeader(to_uri, to_display_name, to_params);\n    this.setHeader('to', this.to.toString()); // From.\n\n    var from_uri = params.from_uri || ua.configuration.uri;\n    var from_params = {\n      tag: params.from_tag || Utils.newTag()\n    };\n    var display_name;\n    if (typeof params.from_display_name !== 'undefined') {\n      display_name = params.from_display_name;\n    } else if (ua.configuration.display_name) {\n      display_name = ua.configuration.display_name;\n    } else {\n      display_name = null;\n    }\n    this.from = new NameAddrHeader(from_uri, display_name, from_params);\n    this.setHeader('from', this.from.toString()); // Call-ID.\n\n    var call_id = params.call_id || ua.configuration.jssip_id + Utils.createRandomToken(15);\n    this.call_id = call_id;\n    this.setHeader('call-id', call_id); // CSeq.\n\n    var cseq = params.cseq || Math.floor(Math.random() * 10000);\n    this.cseq = cseq;\n    this.setHeader('cseq', \"\".concat(cseq, \" \").concat(method));\n  }\n  /**\n   * Replace the the given header by the given value.\n   * -param {String} name header name\n   * -param {String | Array} value header value\n   */\n\n  _createClass(OutgoingRequest, [{\n    key: \"setHeader\",\n    value: function setHeader(name, value) {\n      // Remove the header from extraHeaders if present.\n      var regexp = new RegExp(\"^\\\\s*\".concat(name, \"\\\\s*:\"), 'i');\n      for (var idx = 0; idx < this.extraHeaders.length; idx++) {\n        if (regexp.test(this.extraHeaders[idx])) {\n          this.extraHeaders.splice(idx, 1);\n        }\n      }\n      this.headers[Utils.headerize(name)] = Array.isArray(value) ? value : [value];\n    }\n    /**\n     * Get the value of the given header name at the given position.\n     * -param {String} name header name\n     * -returns {String|undefined} Returns the specified header, null if header doesn't exist.\n     */\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(name) {\n      var headers = this.headers[Utils.headerize(name)];\n      if (headers) {\n        if (headers[0]) {\n          return headers[0];\n        }\n      } else {\n        var regexp = new RegExp(\"^\\\\s*\".concat(name, \"\\\\s*:\"), 'i');\n        var _iterator = _createForOfIteratorHelper(this.extraHeaders),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var header = _step.value;\n            if (regexp.test(header)) {\n              return header.substring(header.indexOf(':') + 1).trim();\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n      return;\n    }\n    /**\n     * Get the header/s of the given name.\n     * -param {String} name header name\n     * -returns {Array} Array with all the headers of the specified name.\n     */\n  }, {\n    key: \"getHeaders\",\n    value: function getHeaders(name) {\n      var headers = this.headers[Utils.headerize(name)];\n      var result = [];\n      if (headers) {\n        var _iterator2 = _createForOfIteratorHelper(headers),\n          _step2;\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var header = _step2.value;\n            result.push(header);\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n        return result;\n      } else {\n        var regexp = new RegExp(\"^\\\\s*\".concat(name, \"\\\\s*:\"), 'i');\n        var _iterator3 = _createForOfIteratorHelper(this.extraHeaders),\n          _step3;\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var _header = _step3.value;\n            if (regexp.test(_header)) {\n              result.push(_header.substring(_header.indexOf(':') + 1).trim());\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n        return result;\n      }\n    }\n    /**\n     * Verify the existence of the given header.\n     * -param {String} name header name\n     * -returns {boolean} true if header with given name exists, false otherwise\n     */\n  }, {\n    key: \"hasHeader\",\n    value: function hasHeader(name) {\n      if (this.headers[Utils.headerize(name)]) {\n        return true;\n      } else {\n        var regexp = new RegExp(\"^\\\\s*\".concat(name, \"\\\\s*:\"), 'i');\n        var _iterator4 = _createForOfIteratorHelper(this.extraHeaders),\n          _step4;\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var header = _step4.value;\n            if (regexp.test(header)) {\n              return true;\n            }\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      }\n      return false;\n    }\n    /**\n     * Parse the current body as a SDP and store the resulting object\n     * into this.sdp.\n     * -param {Boolean} force: Parse even if this.sdp already exists.\n     *\n     * Returns this.sdp.\n     */\n  }, {\n    key: \"parseSDP\",\n    value: function parseSDP(force) {\n      if (!force && this.sdp) {\n        return this.sdp;\n      } else {\n        this.sdp = sdp_transform.parse(this.body || '');\n        return this.sdp;\n      }\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      var msg = \"\".concat(this.method, \" \").concat(this.ruri, \" SIP/2.0\\r\\n\");\n      for (var headerName in this.headers) {\n        if (Object.prototype.hasOwnProperty.call(this.headers, headerName)) {\n          var _iterator5 = _createForOfIteratorHelper(this.headers[headerName]),\n            _step5;\n          try {\n            for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n              var headerValue = _step5.value;\n              msg += \"\".concat(headerName, \": \").concat(headerValue, \"\\r\\n\");\n            }\n          } catch (err) {\n            _iterator5.e(err);\n          } finally {\n            _iterator5.f();\n          }\n        }\n      }\n      var _iterator6 = _createForOfIteratorHelper(this.extraHeaders),\n        _step6;\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var header = _step6.value;\n          msg += \"\".concat(header.trim(), \"\\r\\n\");\n        } // Supported.\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n      var supported = [];\n      switch (this.method) {\n        case JsSIP_C.REGISTER:\n          supported.push('path', 'gruu');\n          break;\n        case JsSIP_C.INVITE:\n          if (this.ua.configuration.session_timers) {\n            supported.push('timer');\n          }\n          if (this.ua.contact.pub_gruu || this.ua.contact.temp_gruu) {\n            supported.push('gruu');\n          }\n          supported.push('ice', 'replaces');\n          break;\n        case JsSIP_C.UPDATE:\n          if (this.ua.configuration.session_timers) {\n            supported.push('timer');\n          }\n          supported.push('ice');\n          break;\n      }\n      supported.push('outbound');\n      var userAgent = this.ua.configuration.user_agent || JsSIP_C.USER_AGENT; // Allow.\n\n      msg += \"Allow: \".concat(JsSIP_C.ALLOWED_METHODS, \"\\r\\n\");\n      msg += \"Supported: \".concat(supported, \"\\r\\n\");\n      msg += \"User-Agent: \".concat(userAgent, \"\\r\\n\");\n      if (this.body) {\n        var length = Utils.str_utf8_length(this.body);\n        msg += \"Content-Length: \".concat(length, \"\\r\\n\\r\\n\");\n        msg += this.body;\n      } else {\n        msg += 'Content-Length: 0\\r\\n\\r\\n';\n      }\n      return msg;\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      var request = new OutgoingRequest(this.method, this.ruri, this.ua);\n      Object.keys(this.headers).forEach(function (name) {\n        request.headers[name] = this.headers[name].slice();\n      }, this);\n      request.body = this.body;\n      request.extraHeaders = Utils.cloneArray(this.extraHeaders);\n      request.to = this.to;\n      request.from = this.from;\n      request.call_id = this.call_id;\n      request.cseq = this.cseq;\n      return request;\n    }\n  }]);\n  return OutgoingRequest;\n}();\nvar InitialOutgoingInviteRequest = /*#__PURE__*/function (_OutgoingRequest) {\n  _inherits(InitialOutgoingInviteRequest, _OutgoingRequest);\n  var _super = _createSuper(InitialOutgoingInviteRequest);\n  function InitialOutgoingInviteRequest(ruri, ua, params, extraHeaders, body) {\n    var _this;\n    _classCallCheck(this, InitialOutgoingInviteRequest);\n    _this = _super.call(this, JsSIP_C.INVITE, ruri, ua, params, extraHeaders, body);\n    _this.transaction = null;\n    return _this;\n  }\n  _createClass(InitialOutgoingInviteRequest, [{\n    key: \"cancel\",\n    value: function cancel(reason) {\n      this.transaction.cancel(reason);\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      var request = new InitialOutgoingInviteRequest(this.ruri, this.ua);\n      Object.keys(this.headers).forEach(function (name) {\n        request.headers[name] = this.headers[name].slice();\n      }, this);\n      request.body = this.body;\n      request.extraHeaders = Utils.cloneArray(this.extraHeaders);\n      request.to = this.to;\n      request.from = this.from;\n      request.call_id = this.call_id;\n      request.cseq = this.cseq;\n      request.transaction = this.transaction;\n      return request;\n    }\n  }]);\n  return InitialOutgoingInviteRequest;\n}(OutgoingRequest);\nvar IncomingMessage = /*#__PURE__*/function () {\n  function IncomingMessage() {\n    _classCallCheck(this, IncomingMessage);\n    this.data = null;\n    this.headers = null;\n    this.method = null;\n    this.via = null;\n    this.via_branch = null;\n    this.call_id = null;\n    this.cseq = null;\n    this.from = null;\n    this.from_tag = null;\n    this.to = null;\n    this.to_tag = null;\n    this.body = null;\n    this.sdp = null;\n  }\n  /**\n  * Insert a header of the given name and value into the last position of the\n  * header array.\n  */\n\n  _createClass(IncomingMessage, [{\n    key: \"addHeader\",\n    value: function addHeader(name, value) {\n      var header = {\n        raw: value\n      };\n      name = Utils.headerize(name);\n      if (this.headers[name]) {\n        this.headers[name].push(header);\n      } else {\n        this.headers[name] = [header];\n      }\n    }\n    /**\n     * Get the value of the given header name at the given position.\n     */\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(name) {\n      var header = this.headers[Utils.headerize(name)];\n      if (header) {\n        if (header[0]) {\n          return header[0].raw;\n        }\n      } else {\n        return;\n      }\n    }\n    /**\n     * Get the header/s of the given name.\n     */\n  }, {\n    key: \"getHeaders\",\n    value: function getHeaders(name) {\n      var headers = this.headers[Utils.headerize(name)];\n      var result = [];\n      if (!headers) {\n        return [];\n      }\n      var _iterator7 = _createForOfIteratorHelper(headers),\n        _step7;\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var header = _step7.value;\n          result.push(header.raw);\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n      return result;\n    }\n    /**\n     * Verify the existence of the given header.\n     */\n  }, {\n    key: \"hasHeader\",\n    value: function hasHeader(name) {\n      return this.headers[Utils.headerize(name)] ? true : false;\n    }\n    /**\n    * Parse the given header on the given index.\n    * -param {String} name header name\n    * -param {Number} [idx=0] header index\n    * -returns {Object|undefined} Parsed header object, undefined if the header\n    *  is not present or in case of a parsing error.\n    */\n  }, {\n    key: \"parseHeader\",\n    value: function parseHeader(name) {\n      var idx = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      name = Utils.headerize(name);\n      if (!this.headers[name]) {\n        logger.debug(\"header \\\"\".concat(name, \"\\\" not present\"));\n        return;\n      } else if (idx >= this.headers[name].length) {\n        logger.debug(\"not so many \\\"\".concat(name, \"\\\" headers present\"));\n        return;\n      }\n      var header = this.headers[name][idx];\n      var value = header.raw;\n      if (header.parsed) {\n        return header.parsed;\n      } // Substitute '-' by '_' for grammar rule matching.\n\n      var parsed = Grammar.parse(value, name.replace(/-/g, '_'));\n      if (parsed === -1) {\n        this.headers[name].splice(idx, 1); // delete from headers\n\n        logger.debug(\"error parsing \\\"\".concat(name, \"\\\" header field with value \\\"\").concat(value, \"\\\"\"));\n        return;\n      } else {\n        header.parsed = parsed;\n        return parsed;\n      }\n    }\n    /**\n     * Message Header attribute selector. Alias of parseHeader.\n     * -param {String} name header name\n     * -param {Number} [idx=0] header index\n     * -returns {Object|undefined} Parsed header object, undefined if the header\n     *  is not present or in case of a parsing error.\n     *\n     * -example\n     * message.s('via',3).port\n     */\n  }, {\n    key: \"s\",\n    value: function s(name, idx) {\n      return this.parseHeader(name, idx);\n    }\n    /**\n    * Replace the value of the given header by the value.\n    * -param {String} name header name\n    * -param {String} value header value\n    */\n  }, {\n    key: \"setHeader\",\n    value: function setHeader(name, value) {\n      var header = {\n        raw: value\n      };\n      this.headers[Utils.headerize(name)] = [header];\n    }\n    /**\n     * Parse the current body as a SDP and store the resulting object\n     * into this.sdp.\n     * -param {Boolean} force: Parse even if this.sdp already exists.\n     *\n     * Returns this.sdp.\n     */\n  }, {\n    key: \"parseSDP\",\n    value: function parseSDP(force) {\n      if (!force && this.sdp) {\n        return this.sdp;\n      } else {\n        this.sdp = sdp_transform.parse(this.body || '');\n        return this.sdp;\n      }\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      return this.data;\n    }\n  }]);\n  return IncomingMessage;\n}();\nvar IncomingRequest = /*#__PURE__*/function (_IncomingMessage) {\n  _inherits(IncomingRequest, _IncomingMessage);\n  var _super2 = _createSuper(IncomingRequest);\n  function IncomingRequest(ua) {\n    var _this2;\n    _classCallCheck(this, IncomingRequest);\n    _this2 = _super2.call(this);\n    _this2.ua = ua;\n    _this2.headers = {};\n    _this2.ruri = null;\n    _this2.transport = null;\n    _this2.server_transaction = null;\n    return _this2;\n  }\n  /**\n  * Stateful reply.\n  * -param {Number} code status code\n  * -param {String} reason reason phrase\n  * -param {Object} headers extra headers\n  * -param {String} body body\n  * -param {Function} [onSuccess] onSuccess callback\n  * -param {Function} [onFailure] onFailure callback\n  */\n\n  _createClass(IncomingRequest, [{\n    key: \"reply\",\n    value: function reply(code, reason, extraHeaders, body, onSuccess, onFailure) {\n      var supported = [];\n      var to = this.getHeader('To');\n      code = code || null;\n      reason = reason || null; // Validate code and reason values.\n\n      if (!code || code < 100 || code > 699) {\n        throw new TypeError(\"Invalid status_code: \".concat(code));\n      } else if (reason && typeof reason !== 'string' && !(reason instanceof String)) {\n        throw new TypeError(\"Invalid reason_phrase: \".concat(reason));\n      }\n      reason = reason || JsSIP_C.REASON_PHRASE[code] || '';\n      extraHeaders = Utils.cloneArray(extraHeaders);\n      if (this.ua.configuration.extra_headers) {\n        extraHeaders = extraHeaders.concat(this.ua.configuration.extra_headers);\n      }\n      var response = \"SIP/2.0 \".concat(code, \" \").concat(reason, \"\\r\\n\");\n      if (this.method === JsSIP_C.INVITE && code > 100 && code <= 200) {\n        var headers = this.getHeaders('record-route');\n        var _iterator8 = _createForOfIteratorHelper(headers),\n          _step8;\n        try {\n          for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n            var header = _step8.value;\n            response += \"Record-Route: \".concat(header, \"\\r\\n\");\n          }\n        } catch (err) {\n          _iterator8.e(err);\n        } finally {\n          _iterator8.f();\n        }\n      }\n      var vias = this.getHeaders('via');\n      var _iterator9 = _createForOfIteratorHelper(vias),\n        _step9;\n      try {\n        for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n          var via = _step9.value;\n          response += \"Via: \".concat(via, \"\\r\\n\");\n        }\n      } catch (err) {\n        _iterator9.e(err);\n      } finally {\n        _iterator9.f();\n      }\n      if (!this.to_tag && code > 100) {\n        to += \";tag=\".concat(Utils.newTag());\n      } else if (this.to_tag && !this.s('to').hasParam('tag')) {\n        to += \";tag=\".concat(this.to_tag);\n      }\n      response += \"To: \".concat(to, \"\\r\\n\");\n      response += \"From: \".concat(this.getHeader('From'), \"\\r\\n\");\n      response += \"Call-ID: \".concat(this.call_id, \"\\r\\n\");\n      response += \"CSeq: \".concat(this.cseq, \" \").concat(this.method, \"\\r\\n\");\n      var _iterator10 = _createForOfIteratorHelper(extraHeaders),\n        _step10;\n      try {\n        for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {\n          var _header2 = _step10.value;\n          response += \"\".concat(_header2.trim(), \"\\r\\n\");\n        } // Supported.\n      } catch (err) {\n        _iterator10.e(err);\n      } finally {\n        _iterator10.f();\n      }\n      switch (this.method) {\n        case JsSIP_C.INVITE:\n          if (this.ua.configuration.session_timers) {\n            supported.push('timer');\n          }\n          if (this.ua.contact.pub_gruu || this.ua.contact.temp_gruu) {\n            supported.push('gruu');\n          }\n          supported.push('ice', 'replaces');\n          break;\n        case JsSIP_C.UPDATE:\n          if (this.ua.configuration.session_timers) {\n            supported.push('timer');\n          }\n          if (body) {\n            supported.push('ice');\n          }\n          supported.push('replaces');\n      }\n      supported.push('outbound'); // Allow and Accept.\n\n      if (this.method === JsSIP_C.OPTIONS) {\n        response += \"Allow: \".concat(JsSIP_C.ALLOWED_METHODS, \"\\r\\n\");\n        response += \"Accept: \".concat(JsSIP_C.ACCEPTED_BODY_TYPES, \"\\r\\n\");\n      } else if (code === 405) {\n        response += \"Allow: \".concat(JsSIP_C.ALLOWED_METHODS, \"\\r\\n\");\n      } else if (code === 415) {\n        response += \"Accept: \".concat(JsSIP_C.ACCEPTED_BODY_TYPES, \"\\r\\n\");\n      }\n      response += \"Supported: \".concat(supported, \"\\r\\n\");\n      if (body) {\n        var length = Utils.str_utf8_length(body);\n        response += 'Content-Type: application/sdp\\r\\n';\n        response += \"Content-Length: \".concat(length, \"\\r\\n\\r\\n\");\n        response += body;\n      } else {\n        response += \"Content-Length: \".concat(0, \"\\r\\n\\r\\n\");\n      }\n      this.server_transaction.receiveResponse(code, response, onSuccess, onFailure);\n    }\n    /**\n    * Stateless reply.\n    * -param {Number} code status code\n    * -param {String} reason reason phrase\n    */\n  }, {\n    key: \"reply_sl\",\n    value: function reply_sl() {\n      var code = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var reason = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var vias = this.getHeaders('via'); // Validate code and reason values.\n\n      if (!code || code < 100 || code > 699) {\n        throw new TypeError(\"Invalid status_code: \".concat(code));\n      } else if (reason && typeof reason !== 'string' && !(reason instanceof String)) {\n        throw new TypeError(\"Invalid reason_phrase: \".concat(reason));\n      }\n      reason = reason || JsSIP_C.REASON_PHRASE[code] || '';\n      var response = \"SIP/2.0 \".concat(code, \" \").concat(reason, \"\\r\\n\");\n      var _iterator11 = _createForOfIteratorHelper(vias),\n        _step11;\n      try {\n        for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {\n          var via = _step11.value;\n          response += \"Via: \".concat(via, \"\\r\\n\");\n        }\n      } catch (err) {\n        _iterator11.e(err);\n      } finally {\n        _iterator11.f();\n      }\n      var to = this.getHeader('To');\n      if (!this.to_tag && code > 100) {\n        to += \";tag=\".concat(Utils.newTag());\n      } else if (this.to_tag && !this.s('to').hasParam('tag')) {\n        to += \";tag=\".concat(this.to_tag);\n      }\n      response += \"To: \".concat(to, \"\\r\\n\");\n      response += \"From: \".concat(this.getHeader('From'), \"\\r\\n\");\n      response += \"Call-ID: \".concat(this.call_id, \"\\r\\n\");\n      response += \"CSeq: \".concat(this.cseq, \" \").concat(this.method, \"\\r\\n\");\n      if (this.ua.configuration.extra_headers) {\n        var _iterator12 = _createForOfIteratorHelper(this.ua.configuration.extra_headers),\n          _step12;\n        try {\n          for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {\n            var header = _step12.value;\n            response += \"\".concat(header.trim(), \"\\r\\n\");\n          }\n        } catch (err) {\n          _iterator12.e(err);\n        } finally {\n          _iterator12.f();\n        }\n      }\n      response += \"Content-Length: \".concat(0, \"\\r\\n\\r\\n\");\n      this.transport.send(response);\n    }\n  }]);\n  return IncomingRequest;\n}(IncomingMessage);\nvar IncomingResponse = /*#__PURE__*/function (_IncomingMessage2) {\n  _inherits(IncomingResponse, _IncomingMessage2);\n  var _super3 = _createSuper(IncomingResponse);\n  function IncomingResponse() {\n    var _this3;\n    _classCallCheck(this, IncomingResponse);\n    _this3 = _super3.call(this);\n    _this3.headers = {};\n    _this3.status_code = null;\n    _this3.reason_phrase = null;\n    return _this3;\n  }\n  return IncomingResponse;\n}(IncomingMessage);\nmodule.exports = {\n  OutgoingRequest: OutgoingRequest,\n  InitialOutgoingInviteRequest: InitialOutgoingInviteRequest,\n  IncomingRequest: IncomingRequest,\n  IncomingResponse: IncomingResponse\n};","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_inherits","subClass","superClass","TypeError","Object","create","value","writable","configurable","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","getPrototypeOf","_createForOfIteratorHelper","allowArrayLike","it","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","_e","f","normalCompletion","didErr","err","step","next","_e2","minLen","_arrayLikeToArray","slice","name","from","test","arr","len","arr2","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","defineProperty","key","_createClass","protoProps","staticProps","sdp_transform","require","Logger","JsSIP_C","Utils","NameAddrHeader","Grammar","logger","OutgoingRequest","method","ruri","ua","params","extraHeaders","body","headers","cloneArray","configuration","extra_headers","concat","route_set","setHeader","use_preloaded_route","transport","sip_uri","MAX_FORWARDS","to_uri","to_params","to_tag","tag","to_display_name","to","from_uri","uri","from_params","from_tag","newTag","display_name","from_display_name","call_id","jssip_id","createRandomToken","cseq","Math","floor","random","regexp","RegExp","idx","splice","headerize","getHeader","_iterator","_step","header","substring","indexOf","trim","getHeaders","_iterator2","_step2","push","_iterator3","_step3","_header","hasHeader","_iterator4","_step4","parseSDP","force","sdp","parse","msg","headerName","hasOwnProperty","_iterator5","_step5","headerValue","_iterator6","_step6","supported","REGISTER","INVITE","session_timers","contact","pub_gruu","temp_gruu","UPDATE","userAgent","user_agent","USER_AGENT","ALLOWED_METHODS","str_utf8_length","clone","request","keys","forEach","InitialOutgoingInviteRequest","_OutgoingRequest","_super","_this","transaction","cancel","reason","IncomingMessage","data","via","via_branch","addHeader","raw","_iterator7","_step7","parseHeader","undefined","debug","parsed","replace","IncomingRequest","_IncomingMessage","_super2","_this2","server_transaction","reply","code","onSuccess","onFailure","String","REASON_PHRASE","response","_iterator8","_step8","vias","_iterator9","_step9","hasParam","_iterator10","_step10","_header2","OPTIONS","ACCEPTED_BODY_TYPES","receiveResponse","reply_sl","_iterator11","_step11","_iterator12","_step12","send","IncomingResponse","_IncomingMessage2","_super3","_this3","status_code","reason_phrase","module","exports"],"sources":["/app/node_modules/jssip/lib-es5/SIPMessage.js"],"sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar sdp_transform = require('sdp-transform');\n\nvar Logger = require('./Logger');\n\nvar JsSIP_C = require('./Constants');\n\nvar Utils = require('./Utils');\n\nvar NameAddrHeader = require('./NameAddrHeader');\n\nvar Grammar = require('./Grammar');\n\nvar logger = new Logger('SIPMessage');\n/**\n * -param {String} method request method\n * -param {String} ruri request uri\n * -param {UA} ua\n * -param {Object} params parameters that will have priority over ua.configuration parameters:\n * <br>\n *  - cseq, call_id, from_tag, from_uri, from_display_name, to_uri, to_tag, route_set\n * -param {Object} [headers] extra headers\n * -param {String} [body]\n */\n\nvar OutgoingRequest = /*#__PURE__*/function () {\n  function OutgoingRequest(method, ruri, ua, params, extraHeaders, body) {\n    _classCallCheck(this, OutgoingRequest);\n\n    // Mandatory parameters check.\n    if (!method || !ruri || !ua) {\n      return null;\n    }\n\n    params = params || {};\n    this.ua = ua;\n    this.headers = {};\n    this.method = method;\n    this.ruri = ruri;\n    this.body = body;\n    this.extraHeaders = Utils.cloneArray(extraHeaders);\n\n    if (this.ua.configuration.extra_headers) {\n      this.extraHeaders = this.extraHeaders.concat(this.ua.configuration.extra_headers);\n    } // Fill the Common SIP Request Headers.\n    // Route.\n\n\n    if (params.route_set) {\n      this.setHeader('route', params.route_set);\n    } else if (ua.configuration.use_preloaded_route) {\n      this.setHeader('route', \"<\".concat(ua.transport.sip_uri, \";lr>\"));\n    } // Via.\n    // Empty Via header. Will be filled by the client transaction.\n\n\n    this.setHeader('via', ''); // Max-Forwards.\n\n    this.setHeader('max-forwards', JsSIP_C.MAX_FORWARDS); // To\n\n    var to_uri = params.to_uri || ruri;\n    var to_params = params.to_tag ? {\n      tag: params.to_tag\n    } : null;\n    var to_display_name = typeof params.to_display_name !== 'undefined' ? params.to_display_name : null;\n    this.to = new NameAddrHeader(to_uri, to_display_name, to_params);\n    this.setHeader('to', this.to.toString()); // From.\n\n    var from_uri = params.from_uri || ua.configuration.uri;\n    var from_params = {\n      tag: params.from_tag || Utils.newTag()\n    };\n    var display_name;\n\n    if (typeof params.from_display_name !== 'undefined') {\n      display_name = params.from_display_name;\n    } else if (ua.configuration.display_name) {\n      display_name = ua.configuration.display_name;\n    } else {\n      display_name = null;\n    }\n\n    this.from = new NameAddrHeader(from_uri, display_name, from_params);\n    this.setHeader('from', this.from.toString()); // Call-ID.\n\n    var call_id = params.call_id || ua.configuration.jssip_id + Utils.createRandomToken(15);\n    this.call_id = call_id;\n    this.setHeader('call-id', call_id); // CSeq.\n\n    var cseq = params.cseq || Math.floor(Math.random() * 10000);\n    this.cseq = cseq;\n    this.setHeader('cseq', \"\".concat(cseq, \" \").concat(method));\n  }\n  /**\n   * Replace the the given header by the given value.\n   * -param {String} name header name\n   * -param {String | Array} value header value\n   */\n\n\n  _createClass(OutgoingRequest, [{\n    key: \"setHeader\",\n    value: function setHeader(name, value) {\n      // Remove the header from extraHeaders if present.\n      var regexp = new RegExp(\"^\\\\s*\".concat(name, \"\\\\s*:\"), 'i');\n\n      for (var idx = 0; idx < this.extraHeaders.length; idx++) {\n        if (regexp.test(this.extraHeaders[idx])) {\n          this.extraHeaders.splice(idx, 1);\n        }\n      }\n\n      this.headers[Utils.headerize(name)] = Array.isArray(value) ? value : [value];\n    }\n    /**\n     * Get the value of the given header name at the given position.\n     * -param {String} name header name\n     * -returns {String|undefined} Returns the specified header, null if header doesn't exist.\n     */\n\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(name) {\n      var headers = this.headers[Utils.headerize(name)];\n\n      if (headers) {\n        if (headers[0]) {\n          return headers[0];\n        }\n      } else {\n        var regexp = new RegExp(\"^\\\\s*\".concat(name, \"\\\\s*:\"), 'i');\n\n        var _iterator = _createForOfIteratorHelper(this.extraHeaders),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var header = _step.value;\n\n            if (regexp.test(header)) {\n              return header.substring(header.indexOf(':') + 1).trim();\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n\n      return;\n    }\n    /**\n     * Get the header/s of the given name.\n     * -param {String} name header name\n     * -returns {Array} Array with all the headers of the specified name.\n     */\n\n  }, {\n    key: \"getHeaders\",\n    value: function getHeaders(name) {\n      var headers = this.headers[Utils.headerize(name)];\n      var result = [];\n\n      if (headers) {\n        var _iterator2 = _createForOfIteratorHelper(headers),\n            _step2;\n\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var header = _step2.value;\n            result.push(header);\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n\n        return result;\n      } else {\n        var regexp = new RegExp(\"^\\\\s*\".concat(name, \"\\\\s*:\"), 'i');\n\n        var _iterator3 = _createForOfIteratorHelper(this.extraHeaders),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var _header = _step3.value;\n\n            if (regexp.test(_header)) {\n              result.push(_header.substring(_header.indexOf(':') + 1).trim());\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n\n        return result;\n      }\n    }\n    /**\n     * Verify the existence of the given header.\n     * -param {String} name header name\n     * -returns {boolean} true if header with given name exists, false otherwise\n     */\n\n  }, {\n    key: \"hasHeader\",\n    value: function hasHeader(name) {\n      if (this.headers[Utils.headerize(name)]) {\n        return true;\n      } else {\n        var regexp = new RegExp(\"^\\\\s*\".concat(name, \"\\\\s*:\"), 'i');\n\n        var _iterator4 = _createForOfIteratorHelper(this.extraHeaders),\n            _step4;\n\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var header = _step4.value;\n\n            if (regexp.test(header)) {\n              return true;\n            }\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      }\n\n      return false;\n    }\n    /**\n     * Parse the current body as a SDP and store the resulting object\n     * into this.sdp.\n     * -param {Boolean} force: Parse even if this.sdp already exists.\n     *\n     * Returns this.sdp.\n     */\n\n  }, {\n    key: \"parseSDP\",\n    value: function parseSDP(force) {\n      if (!force && this.sdp) {\n        return this.sdp;\n      } else {\n        this.sdp = sdp_transform.parse(this.body || '');\n        return this.sdp;\n      }\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      var msg = \"\".concat(this.method, \" \").concat(this.ruri, \" SIP/2.0\\r\\n\");\n\n      for (var headerName in this.headers) {\n        if (Object.prototype.hasOwnProperty.call(this.headers, headerName)) {\n          var _iterator5 = _createForOfIteratorHelper(this.headers[headerName]),\n              _step5;\n\n          try {\n            for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n              var headerValue = _step5.value;\n              msg += \"\".concat(headerName, \": \").concat(headerValue, \"\\r\\n\");\n            }\n          } catch (err) {\n            _iterator5.e(err);\n          } finally {\n            _iterator5.f();\n          }\n        }\n      }\n\n      var _iterator6 = _createForOfIteratorHelper(this.extraHeaders),\n          _step6;\n\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var header = _step6.value;\n          msg += \"\".concat(header.trim(), \"\\r\\n\");\n        } // Supported.\n\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n\n      var supported = [];\n\n      switch (this.method) {\n        case JsSIP_C.REGISTER:\n          supported.push('path', 'gruu');\n          break;\n\n        case JsSIP_C.INVITE:\n          if (this.ua.configuration.session_timers) {\n            supported.push('timer');\n          }\n\n          if (this.ua.contact.pub_gruu || this.ua.contact.temp_gruu) {\n            supported.push('gruu');\n          }\n\n          supported.push('ice', 'replaces');\n          break;\n\n        case JsSIP_C.UPDATE:\n          if (this.ua.configuration.session_timers) {\n            supported.push('timer');\n          }\n\n          supported.push('ice');\n          break;\n      }\n\n      supported.push('outbound');\n      var userAgent = this.ua.configuration.user_agent || JsSIP_C.USER_AGENT; // Allow.\n\n      msg += \"Allow: \".concat(JsSIP_C.ALLOWED_METHODS, \"\\r\\n\");\n      msg += \"Supported: \".concat(supported, \"\\r\\n\");\n      msg += \"User-Agent: \".concat(userAgent, \"\\r\\n\");\n\n      if (this.body) {\n        var length = Utils.str_utf8_length(this.body);\n        msg += \"Content-Length: \".concat(length, \"\\r\\n\\r\\n\");\n        msg += this.body;\n      } else {\n        msg += 'Content-Length: 0\\r\\n\\r\\n';\n      }\n\n      return msg;\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      var request = new OutgoingRequest(this.method, this.ruri, this.ua);\n      Object.keys(this.headers).forEach(function (name) {\n        request.headers[name] = this.headers[name].slice();\n      }, this);\n      request.body = this.body;\n      request.extraHeaders = Utils.cloneArray(this.extraHeaders);\n      request.to = this.to;\n      request.from = this.from;\n      request.call_id = this.call_id;\n      request.cseq = this.cseq;\n      return request;\n    }\n  }]);\n\n  return OutgoingRequest;\n}();\n\nvar InitialOutgoingInviteRequest = /*#__PURE__*/function (_OutgoingRequest) {\n  _inherits(InitialOutgoingInviteRequest, _OutgoingRequest);\n\n  var _super = _createSuper(InitialOutgoingInviteRequest);\n\n  function InitialOutgoingInviteRequest(ruri, ua, params, extraHeaders, body) {\n    var _this;\n\n    _classCallCheck(this, InitialOutgoingInviteRequest);\n\n    _this = _super.call(this, JsSIP_C.INVITE, ruri, ua, params, extraHeaders, body);\n    _this.transaction = null;\n    return _this;\n  }\n\n  _createClass(InitialOutgoingInviteRequest, [{\n    key: \"cancel\",\n    value: function cancel(reason) {\n      this.transaction.cancel(reason);\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      var request = new InitialOutgoingInviteRequest(this.ruri, this.ua);\n      Object.keys(this.headers).forEach(function (name) {\n        request.headers[name] = this.headers[name].slice();\n      }, this);\n      request.body = this.body;\n      request.extraHeaders = Utils.cloneArray(this.extraHeaders);\n      request.to = this.to;\n      request.from = this.from;\n      request.call_id = this.call_id;\n      request.cseq = this.cseq;\n      request.transaction = this.transaction;\n      return request;\n    }\n  }]);\n\n  return InitialOutgoingInviteRequest;\n}(OutgoingRequest);\n\nvar IncomingMessage = /*#__PURE__*/function () {\n  function IncomingMessage() {\n    _classCallCheck(this, IncomingMessage);\n\n    this.data = null;\n    this.headers = null;\n    this.method = null;\n    this.via = null;\n    this.via_branch = null;\n    this.call_id = null;\n    this.cseq = null;\n    this.from = null;\n    this.from_tag = null;\n    this.to = null;\n    this.to_tag = null;\n    this.body = null;\n    this.sdp = null;\n  }\n  /**\n  * Insert a header of the given name and value into the last position of the\n  * header array.\n  */\n\n\n  _createClass(IncomingMessage, [{\n    key: \"addHeader\",\n    value: function addHeader(name, value) {\n      var header = {\n        raw: value\n      };\n      name = Utils.headerize(name);\n\n      if (this.headers[name]) {\n        this.headers[name].push(header);\n      } else {\n        this.headers[name] = [header];\n      }\n    }\n    /**\n     * Get the value of the given header name at the given position.\n     */\n\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(name) {\n      var header = this.headers[Utils.headerize(name)];\n\n      if (header) {\n        if (header[0]) {\n          return header[0].raw;\n        }\n      } else {\n        return;\n      }\n    }\n    /**\n     * Get the header/s of the given name.\n     */\n\n  }, {\n    key: \"getHeaders\",\n    value: function getHeaders(name) {\n      var headers = this.headers[Utils.headerize(name)];\n      var result = [];\n\n      if (!headers) {\n        return [];\n      }\n\n      var _iterator7 = _createForOfIteratorHelper(headers),\n          _step7;\n\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var header = _step7.value;\n          result.push(header.raw);\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n\n      return result;\n    }\n    /**\n     * Verify the existence of the given header.\n     */\n\n  }, {\n    key: \"hasHeader\",\n    value: function hasHeader(name) {\n      return this.headers[Utils.headerize(name)] ? true : false;\n    }\n    /**\n    * Parse the given header on the given index.\n    * -param {String} name header name\n    * -param {Number} [idx=0] header index\n    * -returns {Object|undefined} Parsed header object, undefined if the header\n    *  is not present or in case of a parsing error.\n    */\n\n  }, {\n    key: \"parseHeader\",\n    value: function parseHeader(name) {\n      var idx = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      name = Utils.headerize(name);\n\n      if (!this.headers[name]) {\n        logger.debug(\"header \\\"\".concat(name, \"\\\" not present\"));\n        return;\n      } else if (idx >= this.headers[name].length) {\n        logger.debug(\"not so many \\\"\".concat(name, \"\\\" headers present\"));\n        return;\n      }\n\n      var header = this.headers[name][idx];\n      var value = header.raw;\n\n      if (header.parsed) {\n        return header.parsed;\n      } // Substitute '-' by '_' for grammar rule matching.\n\n\n      var parsed = Grammar.parse(value, name.replace(/-/g, '_'));\n\n      if (parsed === -1) {\n        this.headers[name].splice(idx, 1); // delete from headers\n\n        logger.debug(\"error parsing \\\"\".concat(name, \"\\\" header field with value \\\"\").concat(value, \"\\\"\"));\n        return;\n      } else {\n        header.parsed = parsed;\n        return parsed;\n      }\n    }\n    /**\n     * Message Header attribute selector. Alias of parseHeader.\n     * -param {String} name header name\n     * -param {Number} [idx=0] header index\n     * -returns {Object|undefined} Parsed header object, undefined if the header\n     *  is not present or in case of a parsing error.\n     *\n     * -example\n     * message.s('via',3).port\n     */\n\n  }, {\n    key: \"s\",\n    value: function s(name, idx) {\n      return this.parseHeader(name, idx);\n    }\n    /**\n    * Replace the value of the given header by the value.\n    * -param {String} name header name\n    * -param {String} value header value\n    */\n\n  }, {\n    key: \"setHeader\",\n    value: function setHeader(name, value) {\n      var header = {\n        raw: value\n      };\n      this.headers[Utils.headerize(name)] = [header];\n    }\n    /**\n     * Parse the current body as a SDP and store the resulting object\n     * into this.sdp.\n     * -param {Boolean} force: Parse even if this.sdp already exists.\n     *\n     * Returns this.sdp.\n     */\n\n  }, {\n    key: \"parseSDP\",\n    value: function parseSDP(force) {\n      if (!force && this.sdp) {\n        return this.sdp;\n      } else {\n        this.sdp = sdp_transform.parse(this.body || '');\n        return this.sdp;\n      }\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      return this.data;\n    }\n  }]);\n\n  return IncomingMessage;\n}();\n\nvar IncomingRequest = /*#__PURE__*/function (_IncomingMessage) {\n  _inherits(IncomingRequest, _IncomingMessage);\n\n  var _super2 = _createSuper(IncomingRequest);\n\n  function IncomingRequest(ua) {\n    var _this2;\n\n    _classCallCheck(this, IncomingRequest);\n\n    _this2 = _super2.call(this);\n    _this2.ua = ua;\n    _this2.headers = {};\n    _this2.ruri = null;\n    _this2.transport = null;\n    _this2.server_transaction = null;\n    return _this2;\n  }\n  /**\n  * Stateful reply.\n  * -param {Number} code status code\n  * -param {String} reason reason phrase\n  * -param {Object} headers extra headers\n  * -param {String} body body\n  * -param {Function} [onSuccess] onSuccess callback\n  * -param {Function} [onFailure] onFailure callback\n  */\n\n\n  _createClass(IncomingRequest, [{\n    key: \"reply\",\n    value: function reply(code, reason, extraHeaders, body, onSuccess, onFailure) {\n      var supported = [];\n      var to = this.getHeader('To');\n      code = code || null;\n      reason = reason || null; // Validate code and reason values.\n\n      if (!code || code < 100 || code > 699) {\n        throw new TypeError(\"Invalid status_code: \".concat(code));\n      } else if (reason && typeof reason !== 'string' && !(reason instanceof String)) {\n        throw new TypeError(\"Invalid reason_phrase: \".concat(reason));\n      }\n\n      reason = reason || JsSIP_C.REASON_PHRASE[code] || '';\n      extraHeaders = Utils.cloneArray(extraHeaders);\n\n      if (this.ua.configuration.extra_headers) {\n        extraHeaders = extraHeaders.concat(this.ua.configuration.extra_headers);\n      }\n\n      var response = \"SIP/2.0 \".concat(code, \" \").concat(reason, \"\\r\\n\");\n\n      if (this.method === JsSIP_C.INVITE && code > 100 && code <= 200) {\n        var headers = this.getHeaders('record-route');\n\n        var _iterator8 = _createForOfIteratorHelper(headers),\n            _step8;\n\n        try {\n          for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n            var header = _step8.value;\n            response += \"Record-Route: \".concat(header, \"\\r\\n\");\n          }\n        } catch (err) {\n          _iterator8.e(err);\n        } finally {\n          _iterator8.f();\n        }\n      }\n\n      var vias = this.getHeaders('via');\n\n      var _iterator9 = _createForOfIteratorHelper(vias),\n          _step9;\n\n      try {\n        for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n          var via = _step9.value;\n          response += \"Via: \".concat(via, \"\\r\\n\");\n        }\n      } catch (err) {\n        _iterator9.e(err);\n      } finally {\n        _iterator9.f();\n      }\n\n      if (!this.to_tag && code > 100) {\n        to += \";tag=\".concat(Utils.newTag());\n      } else if (this.to_tag && !this.s('to').hasParam('tag')) {\n        to += \";tag=\".concat(this.to_tag);\n      }\n\n      response += \"To: \".concat(to, \"\\r\\n\");\n      response += \"From: \".concat(this.getHeader('From'), \"\\r\\n\");\n      response += \"Call-ID: \".concat(this.call_id, \"\\r\\n\");\n      response += \"CSeq: \".concat(this.cseq, \" \").concat(this.method, \"\\r\\n\");\n\n      var _iterator10 = _createForOfIteratorHelper(extraHeaders),\n          _step10;\n\n      try {\n        for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {\n          var _header2 = _step10.value;\n          response += \"\".concat(_header2.trim(), \"\\r\\n\");\n        } // Supported.\n\n      } catch (err) {\n        _iterator10.e(err);\n      } finally {\n        _iterator10.f();\n      }\n\n      switch (this.method) {\n        case JsSIP_C.INVITE:\n          if (this.ua.configuration.session_timers) {\n            supported.push('timer');\n          }\n\n          if (this.ua.contact.pub_gruu || this.ua.contact.temp_gruu) {\n            supported.push('gruu');\n          }\n\n          supported.push('ice', 'replaces');\n          break;\n\n        case JsSIP_C.UPDATE:\n          if (this.ua.configuration.session_timers) {\n            supported.push('timer');\n          }\n\n          if (body) {\n            supported.push('ice');\n          }\n\n          supported.push('replaces');\n      }\n\n      supported.push('outbound'); // Allow and Accept.\n\n      if (this.method === JsSIP_C.OPTIONS) {\n        response += \"Allow: \".concat(JsSIP_C.ALLOWED_METHODS, \"\\r\\n\");\n        response += \"Accept: \".concat(JsSIP_C.ACCEPTED_BODY_TYPES, \"\\r\\n\");\n      } else if (code === 405) {\n        response += \"Allow: \".concat(JsSIP_C.ALLOWED_METHODS, \"\\r\\n\");\n      } else if (code === 415) {\n        response += \"Accept: \".concat(JsSIP_C.ACCEPTED_BODY_TYPES, \"\\r\\n\");\n      }\n\n      response += \"Supported: \".concat(supported, \"\\r\\n\");\n\n      if (body) {\n        var length = Utils.str_utf8_length(body);\n        response += 'Content-Type: application/sdp\\r\\n';\n        response += \"Content-Length: \".concat(length, \"\\r\\n\\r\\n\");\n        response += body;\n      } else {\n        response += \"Content-Length: \".concat(0, \"\\r\\n\\r\\n\");\n      }\n\n      this.server_transaction.receiveResponse(code, response, onSuccess, onFailure);\n    }\n    /**\n    * Stateless reply.\n    * -param {Number} code status code\n    * -param {String} reason reason phrase\n    */\n\n  }, {\n    key: \"reply_sl\",\n    value: function reply_sl() {\n      var code = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var reason = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var vias = this.getHeaders('via'); // Validate code and reason values.\n\n      if (!code || code < 100 || code > 699) {\n        throw new TypeError(\"Invalid status_code: \".concat(code));\n      } else if (reason && typeof reason !== 'string' && !(reason instanceof String)) {\n        throw new TypeError(\"Invalid reason_phrase: \".concat(reason));\n      }\n\n      reason = reason || JsSIP_C.REASON_PHRASE[code] || '';\n      var response = \"SIP/2.0 \".concat(code, \" \").concat(reason, \"\\r\\n\");\n\n      var _iterator11 = _createForOfIteratorHelper(vias),\n          _step11;\n\n      try {\n        for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {\n          var via = _step11.value;\n          response += \"Via: \".concat(via, \"\\r\\n\");\n        }\n      } catch (err) {\n        _iterator11.e(err);\n      } finally {\n        _iterator11.f();\n      }\n\n      var to = this.getHeader('To');\n\n      if (!this.to_tag && code > 100) {\n        to += \";tag=\".concat(Utils.newTag());\n      } else if (this.to_tag && !this.s('to').hasParam('tag')) {\n        to += \";tag=\".concat(this.to_tag);\n      }\n\n      response += \"To: \".concat(to, \"\\r\\n\");\n      response += \"From: \".concat(this.getHeader('From'), \"\\r\\n\");\n      response += \"Call-ID: \".concat(this.call_id, \"\\r\\n\");\n      response += \"CSeq: \".concat(this.cseq, \" \").concat(this.method, \"\\r\\n\");\n\n      if (this.ua.configuration.extra_headers) {\n        var _iterator12 = _createForOfIteratorHelper(this.ua.configuration.extra_headers),\n            _step12;\n\n        try {\n          for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {\n            var header = _step12.value;\n            response += \"\".concat(header.trim(), \"\\r\\n\");\n          }\n        } catch (err) {\n          _iterator12.e(err);\n        } finally {\n          _iterator12.f();\n        }\n      }\n\n      response += \"Content-Length: \".concat(0, \"\\r\\n\\r\\n\");\n      this.transport.send(response);\n    }\n  }]);\n\n  return IncomingRequest;\n}(IncomingMessage);\n\nvar IncomingResponse = /*#__PURE__*/function (_IncomingMessage2) {\n  _inherits(IncomingResponse, _IncomingMessage2);\n\n  var _super3 = _createSuper(IncomingResponse);\n\n  function IncomingResponse() {\n    var _this3;\n\n    _classCallCheck(this, IncomingResponse);\n\n    _this3 = _super3.call(this);\n    _this3.headers = {};\n    _this3.status_code = null;\n    _this3.reason_phrase = null;\n    return _this3;\n  }\n\n  return IncomingResponse;\n}(IncomingMessage);\n\nmodule.exports = {\n  OutgoingRequest: OutgoingRequest,\n  InitialOutgoingInviteRequest: InitialOutgoingInviteRequest,\n  IncomingRequest: IncomingRequest,\n  IncomingResponse: IncomingResponse\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}