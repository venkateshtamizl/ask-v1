{"ast":null,"code":"\"use strict\";\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\nvar Logger = require('./Logger');\nvar Socket = require('./Socket');\nvar JsSIP_C = require('./Constants');\nvar logger = new Logger('Transport');\n/**\n * Constants\n */\n\nvar C = {\n  // Transport status.\n  STATUS_CONNECTED: 0,\n  STATUS_CONNECTING: 1,\n  STATUS_DISCONNECTED: 2,\n  // Socket status.\n  SOCKET_STATUS_READY: 0,\n  SOCKET_STATUS_ERROR: 1,\n  // Recovery options.\n  recovery_options: {\n    // minimum interval in seconds between recover attempts.\n    min_interval: JsSIP_C.CONNECTION_RECOVERY_MIN_INTERVAL,\n    // maximum interval in seconds between recover attempts.\n    max_interval: JsSIP_C.CONNECTION_RECOVERY_MAX_INTERVAL\n  }\n};\n/*\n * Manages one or multiple JsSIP.Socket instances.\n * Is reponsible for transport recovery logic among all socket instances.\n *\n * @socket JsSIP::Socket instance\n */\n\nmodule.exports = /*#__PURE__*/function () {\n  function Transport(sockets) {\n    var recovery_options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : C.recovery_options;\n    _classCallCheck(this, Transport);\n    logger.debug('new()');\n    this.status = C.STATUS_DISCONNECTED; // Current socket.\n\n    this.socket = null; // Socket collection.\n\n    this.sockets = [];\n    this.recovery_options = recovery_options;\n    this.recover_attempts = 0;\n    this.recovery_timer = null;\n    this.close_requested = false; // It seems that TextDecoder is not available in some versions of React-Native.\n    // See https://github.com/versatica/JsSIP/issues/695\n\n    try {\n      this.textDecoder = new TextDecoder('utf8');\n    } catch (error) {\n      logger.warn(\"cannot use TextDecoder: \".concat(error));\n    }\n    if (typeof sockets === 'undefined') {\n      throw new TypeError('Invalid argument.' + ' undefined \\'sockets\\' argument');\n    }\n    if (!(sockets instanceof Array)) {\n      sockets = [sockets];\n    }\n    sockets.forEach(function (socket) {\n      if (!Socket.isSocket(socket.socket)) {\n        throw new TypeError('Invalid argument.' + ' invalid \\'JsSIP.Socket\\' instance');\n      }\n      if (socket.weight && !Number(socket.weight)) {\n        throw new TypeError('Invalid argument.' + ' \\'weight\\' attribute is not a number');\n      }\n      this.sockets.push({\n        socket: socket.socket,\n        weight: socket.weight || 0,\n        status: C.SOCKET_STATUS_READY\n      });\n    }, this); // Get the socket with higher weight.\n\n    this._getSocket();\n  }\n  /**\n   * Instance Methods\n   */\n\n  _createClass(Transport, [{\n    key: \"connect\",\n    value: function connect() {\n      logger.debug('connect()');\n      if (this.isConnected()) {\n        logger.debug('Transport is already connected');\n        return;\n      } else if (this.isConnecting()) {\n        logger.debug('Transport is connecting');\n        return;\n      }\n      this.close_requested = false;\n      this.status = C.STATUS_CONNECTING;\n      this.onconnecting({\n        socket: this.socket,\n        attempts: this.recover_attempts\n      });\n      if (!this.close_requested) {\n        // Bind socket event callbacks.\n        this.socket.onconnect = this._onConnect.bind(this);\n        this.socket.ondisconnect = this._onDisconnect.bind(this);\n        this.socket.ondata = this._onData.bind(this);\n        this.socket.connect();\n      }\n      return;\n    }\n  }, {\n    key: \"disconnect\",\n    value: function disconnect() {\n      logger.debug('close()');\n      this.close_requested = true;\n      this.recover_attempts = 0;\n      this.status = C.STATUS_DISCONNECTED; // Clear recovery_timer.\n\n      if (this.recovery_timer !== null) {\n        clearTimeout(this.recovery_timer);\n        this.recovery_timer = null;\n      } // Unbind socket event callbacks.\n\n      this.socket.onconnect = function () {};\n      this.socket.ondisconnect = function () {};\n      this.socket.ondata = function () {};\n      this.socket.disconnect();\n      this.ondisconnect({\n        socket: this.socket,\n        error: false\n      });\n    }\n  }, {\n    key: \"send\",\n    value: function send(data) {\n      logger.debug('send()');\n      if (!this.isConnected()) {\n        logger.warn('unable to send message, transport is not connected');\n        return false;\n      }\n      var message = data.toString();\n      logger.debug(\"sending message:\\n\\n\".concat(message, \"\\n\"));\n      return this.socket.send(message);\n    }\n  }, {\n    key: \"isConnected\",\n    value: function isConnected() {\n      return this.status === C.STATUS_CONNECTED;\n    }\n  }, {\n    key: \"isConnecting\",\n    value: function isConnecting() {\n      return this.status === C.STATUS_CONNECTING;\n    }\n    /**\n     * Private API.\n     */\n  }, {\n    key: \"_reconnect\",\n    value: function _reconnect() {\n      var _this = this;\n      this.recover_attempts += 1;\n      var k = Math.floor(Math.random() * Math.pow(2, this.recover_attempts) + 1);\n      if (k < this.recovery_options.min_interval) {\n        k = this.recovery_options.min_interval;\n      } else if (k > this.recovery_options.max_interval) {\n        k = this.recovery_options.max_interval;\n      }\n      logger.debug(\"reconnection attempt: \".concat(this.recover_attempts, \". next connection attempt in \").concat(k, \" seconds\"));\n      this.recovery_timer = setTimeout(function () {\n        if (!_this.close_requested && !(_this.isConnected() || _this.isConnecting())) {\n          // Get the next available socket with higher weight.\n          _this._getSocket(); // Connect the socket.\n\n          _this.connect();\n        }\n      }, k * 1000);\n    }\n    /**\n     * get the next available socket with higher weight\n     */\n  }, {\n    key: \"_getSocket\",\n    value: function _getSocket() {\n      var candidates = [];\n      this.sockets.forEach(function (socket) {\n        if (socket.status === C.SOCKET_STATUS_ERROR) {\n          return; // continue the array iteration\n        } else if (candidates.length === 0) {\n          candidates.push(socket);\n        } else if (socket.weight > candidates[0].weight) {\n          candidates = [socket];\n        } else if (socket.weight === candidates[0].weight) {\n          candidates.push(socket);\n        }\n      });\n      if (candidates.length === 0) {\n        // All sockets have failed. reset sockets status.\n        this.sockets.forEach(function (socket) {\n          socket.status = C.SOCKET_STATUS_READY;\n        }); // Get next available socket.\n\n        this._getSocket();\n        return;\n      }\n      var idx = Math.floor(Math.random() * candidates.length);\n      this.socket = candidates[idx].socket;\n    }\n    /**\n     * Socket Event Handlers\n     */\n  }, {\n    key: \"_onConnect\",\n    value: function _onConnect() {\n      this.recover_attempts = 0;\n      this.status = C.STATUS_CONNECTED; // Clear recovery_timer.\n\n      if (this.recovery_timer !== null) {\n        clearTimeout(this.recovery_timer);\n        this.recovery_timer = null;\n      }\n      this.onconnect({\n        socket: this\n      });\n    }\n  }, {\n    key: \"_onDisconnect\",\n    value: function _onDisconnect(error, code, reason) {\n      this.status = C.STATUS_DISCONNECTED;\n      this.ondisconnect({\n        socket: this.socket,\n        error: error,\n        code: code,\n        reason: reason\n      });\n      if (this.close_requested) {\n        return;\n      } // Update socket status.\n      else {\n        this.sockets.forEach(function (socket) {\n          if (this.socket === socket.socket) {\n            socket.status = C.SOCKET_STATUS_ERROR;\n          }\n        }, this);\n      }\n      this._reconnect(error);\n    }\n  }, {\n    key: \"_onData\",\n    value: function _onData(data) {\n      // CRLF Keep Alive request from server, reply.\n      if (data === '\\r\\n\\r\\n') {\n        logger.debug('received message with double-CRLF Keep Alive request');\n        try {\n          // Reply with single CRLF.\n          this.socket.send('\\r\\n');\n        } catch (error) {\n          logger.warn(\"error sending Keep Alive response: \".concat(error));\n        }\n        return;\n      } // CRLF Keep Alive response from server, ignore it.\n\n      if (data === '\\r\\n') {\n        logger.debug('received message with CRLF Keep Alive response');\n        return;\n      } // Binary message.\n      else if (typeof data !== 'string') {\n        try {\n          if (this.textDecoder) data = this.textDecoder.decode(data);else data = String.fromCharCode.apply(null, new Uint8Array(data));\n        } catch (evt) {\n          logger.debug('received binary message failed to be converted into string,' + ' message discarded');\n          return;\n        }\n        logger.debug(\"received binary message:\\n\\n\".concat(data, \"\\n\"));\n      } // Text message.\n      else {\n        logger.debug(\"received text message:\\n\\n\".concat(data, \"\\n\"));\n      }\n      this.ondata({\n        transport: this,\n        message: data\n      });\n    }\n  }, {\n    key: \"via_transport\",\n    get: function get() {\n      return this.socket.via_transport;\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this.socket.url;\n    }\n  }, {\n    key: \"sip_uri\",\n    get: function get() {\n      return this.socket.sip_uri;\n    }\n  }]);\n  return Transport;\n}();","map":{"version":3,"names":["_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","Logger","require","Socket","JsSIP_C","logger","C","STATUS_CONNECTED","STATUS_CONNECTING","STATUS_DISCONNECTED","SOCKET_STATUS_READY","SOCKET_STATUS_ERROR","recovery_options","min_interval","CONNECTION_RECOVERY_MIN_INTERVAL","max_interval","CONNECTION_RECOVERY_MAX_INTERVAL","module","exports","Transport","sockets","arguments","undefined","debug","status","socket","recover_attempts","recovery_timer","close_requested","textDecoder","TextDecoder","error","warn","concat","Array","forEach","isSocket","weight","Number","push","_getSocket","value","connect","isConnected","isConnecting","onconnecting","attempts","onconnect","_onConnect","bind","ondisconnect","_onDisconnect","ondata","_onData","disconnect","clearTimeout","send","data","message","toString","_reconnect","_this","k","Math","floor","random","pow","setTimeout","candidates","idx","code","reason","decode","String","fromCharCode","apply","Uint8Array","evt","transport","get","via_transport","url","sip_uri"],"sources":["/etc/asterisk/webrtc-phone/node_modules/jssip/lib-es5/Transport.js"],"sourcesContent":["\"use strict\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Logger = require('./Logger');\n\nvar Socket = require('./Socket');\n\nvar JsSIP_C = require('./Constants');\n\nvar logger = new Logger('Transport');\n/**\n * Constants\n */\n\nvar C = {\n  // Transport status.\n  STATUS_CONNECTED: 0,\n  STATUS_CONNECTING: 1,\n  STATUS_DISCONNECTED: 2,\n  // Socket status.\n  SOCKET_STATUS_READY: 0,\n  SOCKET_STATUS_ERROR: 1,\n  // Recovery options.\n  recovery_options: {\n    // minimum interval in seconds between recover attempts.\n    min_interval: JsSIP_C.CONNECTION_RECOVERY_MIN_INTERVAL,\n    // maximum interval in seconds between recover attempts.\n    max_interval: JsSIP_C.CONNECTION_RECOVERY_MAX_INTERVAL\n  }\n};\n/*\n * Manages one or multiple JsSIP.Socket instances.\n * Is reponsible for transport recovery logic among all socket instances.\n *\n * @socket JsSIP::Socket instance\n */\n\nmodule.exports = /*#__PURE__*/function () {\n  function Transport(sockets) {\n    var recovery_options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : C.recovery_options;\n\n    _classCallCheck(this, Transport);\n\n    logger.debug('new()');\n    this.status = C.STATUS_DISCONNECTED; // Current socket.\n\n    this.socket = null; // Socket collection.\n\n    this.sockets = [];\n    this.recovery_options = recovery_options;\n    this.recover_attempts = 0;\n    this.recovery_timer = null;\n    this.close_requested = false; // It seems that TextDecoder is not available in some versions of React-Native.\n    // See https://github.com/versatica/JsSIP/issues/695\n\n    try {\n      this.textDecoder = new TextDecoder('utf8');\n    } catch (error) {\n      logger.warn(\"cannot use TextDecoder: \".concat(error));\n    }\n\n    if (typeof sockets === 'undefined') {\n      throw new TypeError('Invalid argument.' + ' undefined \\'sockets\\' argument');\n    }\n\n    if (!(sockets instanceof Array)) {\n      sockets = [sockets];\n    }\n\n    sockets.forEach(function (socket) {\n      if (!Socket.isSocket(socket.socket)) {\n        throw new TypeError('Invalid argument.' + ' invalid \\'JsSIP.Socket\\' instance');\n      }\n\n      if (socket.weight && !Number(socket.weight)) {\n        throw new TypeError('Invalid argument.' + ' \\'weight\\' attribute is not a number');\n      }\n\n      this.sockets.push({\n        socket: socket.socket,\n        weight: socket.weight || 0,\n        status: C.SOCKET_STATUS_READY\n      });\n    }, this); // Get the socket with higher weight.\n\n    this._getSocket();\n  }\n  /**\n   * Instance Methods\n   */\n\n\n  _createClass(Transport, [{\n    key: \"connect\",\n    value: function connect() {\n      logger.debug('connect()');\n\n      if (this.isConnected()) {\n        logger.debug('Transport is already connected');\n        return;\n      } else if (this.isConnecting()) {\n        logger.debug('Transport is connecting');\n        return;\n      }\n\n      this.close_requested = false;\n      this.status = C.STATUS_CONNECTING;\n      this.onconnecting({\n        socket: this.socket,\n        attempts: this.recover_attempts\n      });\n\n      if (!this.close_requested) {\n        // Bind socket event callbacks.\n        this.socket.onconnect = this._onConnect.bind(this);\n        this.socket.ondisconnect = this._onDisconnect.bind(this);\n        this.socket.ondata = this._onData.bind(this);\n        this.socket.connect();\n      }\n\n      return;\n    }\n  }, {\n    key: \"disconnect\",\n    value: function disconnect() {\n      logger.debug('close()');\n      this.close_requested = true;\n      this.recover_attempts = 0;\n      this.status = C.STATUS_DISCONNECTED; // Clear recovery_timer.\n\n      if (this.recovery_timer !== null) {\n        clearTimeout(this.recovery_timer);\n        this.recovery_timer = null;\n      } // Unbind socket event callbacks.\n\n\n      this.socket.onconnect = function () {};\n\n      this.socket.ondisconnect = function () {};\n\n      this.socket.ondata = function () {};\n\n      this.socket.disconnect();\n      this.ondisconnect({\n        socket: this.socket,\n        error: false\n      });\n    }\n  }, {\n    key: \"send\",\n    value: function send(data) {\n      logger.debug('send()');\n\n      if (!this.isConnected()) {\n        logger.warn('unable to send message, transport is not connected');\n        return false;\n      }\n\n      var message = data.toString();\n      logger.debug(\"sending message:\\n\\n\".concat(message, \"\\n\"));\n      return this.socket.send(message);\n    }\n  }, {\n    key: \"isConnected\",\n    value: function isConnected() {\n      return this.status === C.STATUS_CONNECTED;\n    }\n  }, {\n    key: \"isConnecting\",\n    value: function isConnecting() {\n      return this.status === C.STATUS_CONNECTING;\n    }\n    /**\n     * Private API.\n     */\n\n  }, {\n    key: \"_reconnect\",\n    value: function _reconnect() {\n      var _this = this;\n\n      this.recover_attempts += 1;\n      var k = Math.floor(Math.random() * Math.pow(2, this.recover_attempts) + 1);\n\n      if (k < this.recovery_options.min_interval) {\n        k = this.recovery_options.min_interval;\n      } else if (k > this.recovery_options.max_interval) {\n        k = this.recovery_options.max_interval;\n      }\n\n      logger.debug(\"reconnection attempt: \".concat(this.recover_attempts, \". next connection attempt in \").concat(k, \" seconds\"));\n      this.recovery_timer = setTimeout(function () {\n        if (!_this.close_requested && !(_this.isConnected() || _this.isConnecting())) {\n          // Get the next available socket with higher weight.\n          _this._getSocket(); // Connect the socket.\n\n\n          _this.connect();\n        }\n      }, k * 1000);\n    }\n    /**\n     * get the next available socket with higher weight\n     */\n\n  }, {\n    key: \"_getSocket\",\n    value: function _getSocket() {\n      var candidates = [];\n      this.sockets.forEach(function (socket) {\n        if (socket.status === C.SOCKET_STATUS_ERROR) {\n          return; // continue the array iteration\n        } else if (candidates.length === 0) {\n          candidates.push(socket);\n        } else if (socket.weight > candidates[0].weight) {\n          candidates = [socket];\n        } else if (socket.weight === candidates[0].weight) {\n          candidates.push(socket);\n        }\n      });\n\n      if (candidates.length === 0) {\n        // All sockets have failed. reset sockets status.\n        this.sockets.forEach(function (socket) {\n          socket.status = C.SOCKET_STATUS_READY;\n        }); // Get next available socket.\n\n        this._getSocket();\n\n        return;\n      }\n\n      var idx = Math.floor(Math.random() * candidates.length);\n      this.socket = candidates[idx].socket;\n    }\n    /**\n     * Socket Event Handlers\n     */\n\n  }, {\n    key: \"_onConnect\",\n    value: function _onConnect() {\n      this.recover_attempts = 0;\n      this.status = C.STATUS_CONNECTED; // Clear recovery_timer.\n\n      if (this.recovery_timer !== null) {\n        clearTimeout(this.recovery_timer);\n        this.recovery_timer = null;\n      }\n\n      this.onconnect({\n        socket: this\n      });\n    }\n  }, {\n    key: \"_onDisconnect\",\n    value: function _onDisconnect(error, code, reason) {\n      this.status = C.STATUS_DISCONNECTED;\n      this.ondisconnect({\n        socket: this.socket,\n        error: error,\n        code: code,\n        reason: reason\n      });\n\n      if (this.close_requested) {\n        return;\n      } // Update socket status.\n      else {\n          this.sockets.forEach(function (socket) {\n            if (this.socket === socket.socket) {\n              socket.status = C.SOCKET_STATUS_ERROR;\n            }\n          }, this);\n        }\n\n      this._reconnect(error);\n    }\n  }, {\n    key: \"_onData\",\n    value: function _onData(data) {\n      // CRLF Keep Alive request from server, reply.\n      if (data === '\\r\\n\\r\\n') {\n        logger.debug('received message with double-CRLF Keep Alive request');\n\n        try {\n          // Reply with single CRLF.\n          this.socket.send('\\r\\n');\n        } catch (error) {\n          logger.warn(\"error sending Keep Alive response: \".concat(error));\n        }\n\n        return;\n      } // CRLF Keep Alive response from server, ignore it.\n\n\n      if (data === '\\r\\n') {\n        logger.debug('received message with CRLF Keep Alive response');\n        return;\n      } // Binary message.\n      else if (typeof data !== 'string') {\n          try {\n            if (this.textDecoder) data = this.textDecoder.decode(data);else data = String.fromCharCode.apply(null, new Uint8Array(data));\n          } catch (evt) {\n            logger.debug('received binary message failed to be converted into string,' + ' message discarded');\n            return;\n          }\n\n          logger.debug(\"received binary message:\\n\\n\".concat(data, \"\\n\"));\n        } // Text message.\n        else {\n            logger.debug(\"received text message:\\n\\n\".concat(data, \"\\n\"));\n          }\n\n      this.ondata({\n        transport: this,\n        message: data\n      });\n    }\n  }, {\n    key: \"via_transport\",\n    get: function get() {\n      return this.socket.via_transport;\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this.socket.url;\n    }\n  }, {\n    key: \"sip_uri\",\n    get: function get() {\n      return this.socket.sip_uri;\n    }\n  }]);\n\n  return Transport;\n}();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}